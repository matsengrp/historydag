<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>historydag.HistoryDag &mdash; historydag  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="historydag.HistoryDagNode" href="historydag.HistoryDagNode.html" />
    <link rel="prev" title="Description" href="../api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api.html">Description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html#classes">Classes</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">historydag.HistoryDag</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#historydag.HistoryDag"><code class="docutils literal notranslate"><span class="pre">HistoryDag</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.__init__"><code class="docutils literal notranslate"><span class="pre">HistoryDag.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.from_history_dag"><code class="docutils literal notranslate"><span class="pre">HistoryDag.from_history_dag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">HistoryDag.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_label_type"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_label_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.trim_below_weight"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_below_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_leaves"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_leaves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_annotated_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_annotated_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.num_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.num_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.num_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.num_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.num_leaves"><code class="docutils literal notranslate"><span class="pre">HistoryDag.num_leaves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.find_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.find_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.find_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.find_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sample"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.nodes_above_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.nodes_above_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sample_with_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample_with_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sample_with_edge"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample_with_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.iter_covering_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.iter_covering_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.unlabel"><code class="docutils literal notranslate"><span class="pre">HistoryDag.unlabel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.relabel"><code class="docutils literal notranslate"><span class="pre">HistoryDag.relabel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.add_label_fields"><code class="docutils literal notranslate"><span class="pre">HistoryDag.add_label_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.remove_label_fields"><code class="docutils literal notranslate"><span class="pre">HistoryDag.remove_label_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.update_label_fields"><code class="docutils literal notranslate"><span class="pre">HistoryDag.update_label_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.is_history"><code class="docutils literal notranslate"><span class="pre">HistoryDag.is_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.is_clade_tree"><code class="docutils literal notranslate"><span class="pre">HistoryDag.is_clade_tree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.copy"><code class="docutils literal notranslate"><span class="pre">HistoryDag.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.history_intersect"><code class="docutils literal notranslate"><span class="pre">HistoryDag.history_intersect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.shared_history_count"><code class="docutils literal notranslate"><span class="pre">HistoryDag.shared_history_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.merge"><code class="docutils literal notranslate"><span class="pre">HistoryDag.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.add_all_allowed_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.add_all_allowed_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.make_complete"><code class="docutils literal notranslate"><span class="pre">HistoryDag.make_complete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.to_newick"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_newick()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.to_ascii"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_ascii()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.to_ete"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_ete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.to_graphviz"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_graphviz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.internal_avg_parents"><code class="docutils literal notranslate"><span class="pre">HistoryDag.internal_avg_parents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.explode_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.explode_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.leaf_path_uncertainty_dag"><code class="docutils literal notranslate"><span class="pre">HistoryDag.leaf_path_uncertainty_dag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.leaf_path_uncertainty_graphviz"><code class="docutils literal notranslate"><span class="pre">HistoryDag.leaf_path_uncertainty_graphviz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.summary"><code class="docutils literal notranslate"><span class="pre">HistoryDag.summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.label_uncertainty_summary"><code class="docutils literal notranslate"><span class="pre">HistoryDag.label_uncertainty_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.postorder_history_accum"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_history_accum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.postorder_cladetree_accum"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_cladetree_accum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.optimal_weight_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_optimal_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_optimal_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sum_weights"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sum_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.weight_count"><code class="docutils literal notranslate"><span class="pre">HistoryDag.weight_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.weight_range_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.weight_range_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.hamming_parsimony_count"><code class="docutils literal notranslate"><span class="pre">HistoryDag.hamming_parsimony_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.to_newicks"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_topologies"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_topologies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_topologies_fast"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_topologies_fast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.preorder_history_accum"><code class="docutils literal notranslate"><span class="pre">HistoryDag.preorder_history_accum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.most_supported_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.most_supported_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_paths_to_leaf"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_paths_to_leaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.weight_counts_with_ambiguities"><code class="docutils literal notranslate"><span class="pre">HistoryDag.weight_counts_with_ambiguities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.underestimate_rf_diameter"><code class="docutils literal notranslate"><span class="pre">HistoryDag.underestimate_rf_diameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.overestimate_rf_diameter"><code class="docutils literal notranslate"><span class="pre">HistoryDag.overestimate_rf_diameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.optimal_sum_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.optimal_sum_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_sum_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_sum_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.optimal_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.optimal_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_rf_distances"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_rf_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.count_sum_rf_distances"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_sum_rf_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sum_rf_distances"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sum_rf_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.average_pairwise_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.average_pairwise_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_weight"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_topologies"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.trim_topology"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_topology()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.export_edge_probabilities"><code class="docutils literal notranslate"><span class="pre">HistoryDag.export_edge_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.get_probability_countfuncs"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_probability_countfuncs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.sum_probability"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sum_probability()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.node_probabilities"><code class="docutils literal notranslate"><span class="pre">HistoryDag.node_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.probability_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.probability_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.natural_distribution_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.natural_distribution_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.uniform_distribution_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.uniform_distribution_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.make_uniform"><code class="docutils literal notranslate"><span class="pre">HistoryDag.make_uniform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.recompute_parents"><code class="docutils literal notranslate"><span class="pre">HistoryDag.recompute_parents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.convert_to_collapsed"><code class="docutils literal notranslate"><span class="pre">HistoryDag.convert_to_collapsed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.add_node_at_all_possible_places"><code class="docutils literal notranslate"><span class="pre">HistoryDag.add_node_at_all_possible_places()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.insert_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.insert_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.postorder_above"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_above()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.postorder"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.HistoryDag.preorder"><code class="docutils literal notranslate"><span class="pre">HistoryDag.preorder()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="historydag.HistoryDagNode.html">historydag.HistoryDagNode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#functions">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#modules">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">historydag</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">Description</a></li>
      <li class="breadcrumb-item active">historydag.HistoryDag</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="historydag-historydag">
<h1>historydag.HistoryDag<a class="headerlink" href="#historydag-historydag" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="historydag.HistoryDag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">historydag.</span></span><span class="sig-name descname"><span class="pre">HistoryDag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dagroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag" title="Link to this definition"></a></dt>
<dd><p>An object to represent a collection of internally labeled trees. A
wrapper object to contain exposed HistoryDag methods and point to a
HistoryDagNode root.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dagroot</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a></span>) – The root node of the history DAG</p></li>
<li><p><strong>attr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – An attribute to contain data which will be preserved by copying (default and empty dict)</p></li>
</ul>
</dd>
</dl>
<p>Subclassing HistoryDag:
HistoryDag may be subclassed without overriding __init__, by defining a <cite>_required_label_fields</cite> class variable
for any subclasses.</p>
<p>The value of <cite>_required_label_fields</cite> should be a dictionary keyed by label fields that are expected by methods
of the subclass. Each dictionary entry shall be of the form <cite>required_field: [(from_fields, conversion_func), …]</cite>, where
the dict value is a list of tuples, with each <cite>conversion_func</cite> a function mapping <cite>HistoryDagNode`s to the value of
that node label’s `required_field</cite> field, and <cite>from_fields</cite> a tuple containing all label fields expected by that function.</p>
<p>Keyword arguments passed to <a class="reference internal" href="#historydag.HistoryDag.from_history_dag" title="historydag.HistoryDag.from_history_dag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.from_history_dag()</span></code></a> will be passed to conversion functions provided in the
appropriate subclass’s <cite>_required_label_fields</cite> attribute. Be sure to document each subclass, including available
conversion functions and their keywords, in each subclass’s docstring.</p>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dagroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="historydag.HistoryDag.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(dagroot[, attr])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.add_all_allowed_edges" title="historydag.HistoryDag.add_all_allowed_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_all_allowed_edges</span></code></a>(*args, **kwargs)</p></td>
<td><p>Provided as a deprecated synonym for <a class="reference internal" href="#historydag.HistoryDag.make_complete" title="historydag.HistoryDag.make_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_complete()</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.add_label_fields" title="historydag.HistoryDag.add_label_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_label_fields</span></code></a>([new_field_names, ...])</p></td>
<td><p>Returns a copy of the DAG in which each node's label is extended to include the new fields listed in <cite>new_field_names</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.add_node_at_all_possible_places" title="historydag.HistoryDag.add_node_at_all_possible_places"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_node_at_all_possible_places</span></code></a>(new_leaf_id)</p></td>
<td><p>Inserts a sequence into the dag such that every tree in the dag now contains that new node.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.average_pairwise_rf_distance" title="historydag.HistoryDag.average_pairwise_rf_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">average_pairwise_rf_distance</span></code></a>([...])</p></td>
<td><p>Return the average Robinson-Foulds distance between pairs of histories.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.convert_to_collapsed" title="historydag.HistoryDag.convert_to_collapsed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_to_collapsed</span></code></a>()</p></td>
<td><p>Rebuilds the DAG so that no edge connects two nodes with the same label, unless one is a leaf node.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.copy" title="historydag.HistoryDag.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Uses bytestring serialization, and is guaranteed to copy: :rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_edges" title="historydag.HistoryDag.count_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_edges</span></code></a>([collapsed])</p></td>
<td><p>Counts the number of trees each edge takes part in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_histories" title="historydag.HistoryDag.count_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_histories</span></code></a>([expand_func, ...])</p></td>
<td><p>Annotates each node in the DAG with the number of clade sub-trees underneath.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_nodes" title="historydag.HistoryDag.count_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_nodes</span></code></a>([collapse, rooted])</p></td>
<td><p>Counts the number of trees each node takes part in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_optimal_histories" title="historydag.HistoryDag.count_optimal_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_optimal_histories</span></code></a>([start_func, ...])</p></td>
<td><p>Count the number of histories which would be left if the DAG were trimmed.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_paths_to_leaf" title="historydag.HistoryDag.count_paths_to_leaf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_paths_to_leaf</span></code></a>(leaf_label[, ...])</p></td>
<td><p>Annotates each node in the DAG with the number of paths to <code class="docutils literal notranslate"><span class="pre">leaf_label</span></code> underneath.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_rf_distances" title="historydag.HistoryDag.count_rf_distances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_rf_distances</span></code></a>(history[, rooted, ...])</p></td>
<td><p>Returns a Counter containing all RF distances to a given history.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_sum_rf_distances" title="historydag.HistoryDag.count_sum_rf_distances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_sum_rf_distances</span></code></a>(reference_dag[, ...])</p></td>
<td><p>Returns a Counter containing all sum RF distances to a given reference DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_topologies" title="historydag.HistoryDag.count_topologies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_topologies</span></code></a>([collapse_leaves])</p></td>
<td><p>Counts the number of unique topologies in the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_topologies_fast" title="historydag.HistoryDag.count_topologies_fast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_topologies_fast</span></code></a>()</p></td>
<td><p>Counts the number of unique topologies in the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.count_trees" title="historydag.HistoryDag.count_trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_trees</span></code></a>(*args, **kwargs)</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.count_histories" title="historydag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_histories()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">edge_probabilities</span></code>([log_probabilities, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.explode_nodes" title="historydag.HistoryDag.explode_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explode_nodes</span></code></a>([expand_func, ...])</p></td>
<td><p>Explode nodes according to a provided function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.export_edge_probabilities" title="historydag.HistoryDag.export_edge_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">export_edge_probabilities</span></code></a>()</p></td>
<td><p>Return a dictionary keyed by (parent, child) <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a> pairs, with downward conditional edge probabilities as values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.find_node" title="historydag.HistoryDag.find_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_node</span></code></a>(filter_func)</p></td>
<td><p>Return the first (non-UA) node for which <code class="docutils literal notranslate"><span class="pre">filter_func</span></code> evaluates to True.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.find_nodes" title="historydag.HistoryDag.find_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_nodes</span></code></a>(filter_func)</p></td>
<td><p>Return a generator on (non-UA) nodes for which <code class="docutils literal notranslate"><span class="pre">filter_func</span></code> evaluates to True.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.from_history_dag" title="historydag.HistoryDag.from_history_dag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_history_dag</span></code></a>(dag[, label_fields])</p></td>
<td><p>Converts HistoryDag instances between subclasses of HistoryDag.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_annotated_edges" title="historydag.HistoryDag.get_annotated_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_annotated_edges</span></code></a>([skip_ua_node])</p></td>
<td><p>Return a generator containing all edges in the history DAG, and their weights and downward conditional edge probabilities.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_edges" title="historydag.HistoryDag.get_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_edges</span></code></a>([skip_ua_node])</p></td>
<td><p>Return a generator containing all edges in the history DAG, as parent, child node tuples.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_histories" title="historydag.HistoryDag.get_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_histories</span></code></a>()</p></td>
<td><p>Return a generator containing all histories in the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_label_type" title="historydag.HistoryDag.get_label_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_label_type</span></code></a>()</p></td>
<td><p>Return the type for labels on this dag's nodes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_leaves" title="historydag.HistoryDag.get_leaves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_leaves</span></code></a>()</p></td>
<td><p>Return a generator containing all leaf nodes in the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_probability_countfuncs" title="historydag.HistoryDag.get_probability_countfuncs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_probability_countfuncs</span></code></a>([...])</p></td>
<td><p>Produce a <a class="reference internal" href="historydag.utils.html#historydag.utils.AddFuncDict" title="historydag.utils.AddFuncDict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.utils.AddFuncDict()</span></code></a> containing functions to compute history probabilities using e.g. <a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.optimal_weight_annotate()</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_topologies" title="historydag.HistoryDag.get_topologies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_topologies</span></code></a>([collapse_leaves])</p></td>
<td><p>Return a list of pseudo-newick representations of topologies in the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.get_trees" title="historydag.HistoryDag.get_trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_trees</span></code></a>()</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.get_histories" title="historydag.HistoryDag.get_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_histories()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.hamming_parsimony_count" title="historydag.HistoryDag.hamming_parsimony_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hamming_parsimony_count</span></code></a>()</p></td>
<td><p>Deprecated in favor of <a class="reference internal" href="historydag.sequence_dag.html#historydag.sequence_dag.SequenceHistoryDag.hamming_parsimony_count" title="historydag.sequence_dag.SequenceHistoryDag.hamming_parsimony_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sequence_dag.SequenceHistoryDag.hamming_parsimony_count()</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.history_intersect" title="historydag.HistoryDag.history_intersect"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_intersect</span></code></a>(reference_dag[, key])</p></td>
<td><p>Modify this HistoryDag to contain only the histories which are also contained in <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.insert_node" title="historydag.HistoryDag.insert_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insert_node</span></code></a>(new_leaf_id[, id_name, ...])</p></td>
<td><p>Inserts a sequence into the DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.internal_avg_parents" title="historydag.HistoryDag.internal_avg_parents"><code class="xref py py-obj docutils literal notranslate"><span class="pre">internal_avg_parents</span></code></a>()</p></td>
<td><p>Returns the average number of parents among internal nodes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.is_clade_tree" title="historydag.HistoryDag.is_clade_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_clade_tree</span></code></a>()</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.is_history" title="historydag.HistoryDag.is_history"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_history()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.is_history" title="historydag.HistoryDag.is_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_history</span></code></a>()</p></td>
<td><p>Returns whether history DAG is a history.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.iter_covering_histories" title="historydag.HistoryDag.iter_covering_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter_covering_histories</span></code></a>([cover_edges])</p></td>
<td><p>Samples a sequence of histories which together contain all nodes in the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.label_uncertainty_summary" title="historydag.HistoryDag.label_uncertainty_summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_uncertainty_summary</span></code></a>()</p></td>
<td><p>Print information about internal nodes which have the same child clades but different labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.leaf_path_uncertainty_dag" title="historydag.HistoryDag.leaf_path_uncertainty_dag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">leaf_path_uncertainty_dag</span></code></a>(terminal_node[, ...])</p></td>
<td><p>Create a DAG of possible paths leading to <cite>terminal_node</cite></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.leaf_path_uncertainty_graphviz" title="historydag.HistoryDag.leaf_path_uncertainty_graphviz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">leaf_path_uncertainty_graphviz</span></code></a>(terminal_node)</p></td>
<td><p>Create a graphviz DAG of possible paths leading to <cite>terminal_node</cite></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.make_complete" title="historydag.HistoryDag.make_complete"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_complete</span></code></a>([new_from_root, ...])</p></td>
<td><p>Add all allowed edges to the DAG in place.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.make_uniform" title="historydag.HistoryDag.make_uniform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_uniform</span></code></a>()</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.uniform_distribution_annotate" title="historydag.HistoryDag.uniform_distribution_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.uniform_distribution_annotate()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_history_weight</span></code>([edge_weight_func])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.merge" title="historydag.HistoryDag.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge</span></code></a>(trees)</p></td>
<td><p>Graph union this history DAG with all those in a list of history DAGs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.most_supported_trees" title="historydag.HistoryDag.most_supported_trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">most_supported_trees</span></code></a>()</p></td>
<td><p>Trims the DAG to only express the trees that have the highest support.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.natural_distribution_annotate" title="historydag.HistoryDag.natural_distribution_annotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">natural_distribution_annotate</span></code></a>([...])</p></td>
<td><p>Set edge probabilities to 1/n, where n is the count of edges descending from the corresponding node-clade pair.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.node_probabilities" title="historydag.HistoryDag.node_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">node_probabilities</span></code></a>([log_probabilities, ...])</p></td>
<td><p>Compute the probability of each node in the DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.nodes_above_node" title="historydag.HistoryDag.nodes_above_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nodes_above_node</span></code></a>(node)</p></td>
<td><p>Return a set of nodes from which the passed node is reachable along directed edges.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.num_edges" title="historydag.HistoryDag.num_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_edges</span></code></a>([skip_ua_node])</p></td>
<td><p>Return the number of edges in the DAG, including edges descending from the UA node, unless skip_ua_node is True.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.num_leaves" title="historydag.HistoryDag.num_leaves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_leaves</span></code></a>()</p></td>
<td><p>Return the number of leaf nodes in the DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.num_nodes" title="historydag.HistoryDag.num_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_nodes</span></code></a>()</p></td>
<td><p>Return the number of nodes in the DAG, not counting the UA node.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.optimal_rf_distance" title="historydag.HistoryDag.optimal_rf_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimal_rf_distance</span></code></a>(history[, rooted, ...])</p></td>
<td><p>Returns the optimal (min or max) RF distance to a given history.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.optimal_sum_rf_distance" title="historydag.HistoryDag.optimal_sum_rf_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimal_sum_rf_distance</span></code></a>(reference_dag[, ...])</p></td>
<td><p>Returns the optimal (min or max) summed rooted RF distance to all histories in the reference DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimal_weight_annotate</span></code></a>([start_func, ...])</p></td>
<td><p>A template method for finding the optimal tree weight in the DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.overestimate_rf_diameter" title="historydag.HistoryDag.overestimate_rf_diameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">overestimate_rf_diameter</span></code></a>()</p></td>
<td><p>Returns an overestimate of the RF diameter of the DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.postorder" title="historydag.HistoryDag.postorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postorder</span></code></a>([include_root])</p></td>
<td><p>Recursive postorder traversal of the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.postorder_above" title="historydag.HistoryDag.postorder_above"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postorder_above</span></code></a>(terminal_node[, ...])</p></td>
<td><p>Recursive postorder traversal of all ancestors of a (possibly internal) node.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.postorder_cladetree_accum" title="historydag.HistoryDag.postorder_cladetree_accum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postorder_cladetree_accum</span></code></a>(*args, **kwargs)</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.postorder_history_accum" title="historydag.HistoryDag.postorder_history_accum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.postorder_history_accum()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.postorder_history_accum" title="historydag.HistoryDag.postorder_history_accum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">postorder_history_accum</span></code></a>(leaf_func, ...[, ...])</p></td>
<td><p>A template method for leaf-to-root dynamic programming.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.preorder" title="historydag.HistoryDag.preorder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preorder</span></code></a>([skip_ua_node, skip_root])</p></td>
<td><p>Recursive postorder traversal of the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.preorder_history_accum" title="historydag.HistoryDag.preorder_history_accum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preorder_history_accum</span></code></a>(leaf_func, edge_func, ...)</p></td>
<td><p>A template method for leaf-to-root and root-to-leaf dynamic programming.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.probability_annotate" title="historydag.HistoryDag.probability_annotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">probability_annotate</span></code></a>(edge_weight_func[, ...])</p></td>
<td><p>Uses the supplied edge weight function to compute conditional probabilities on edges.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.recompute_parents" title="historydag.HistoryDag.recompute_parents"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recompute_parents</span></code></a>()</p></td>
<td><p>Repopulate <code class="docutils literal notranslate"><span class="pre">HistoryDagNode.parent</span></code> attributes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.relabel" title="historydag.HistoryDag.relabel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relabel</span></code></a>(relabel_func[, relax_type])</p></td>
<td><p>Return a new HistoryDag with labels modified according to a provided function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.remove_label_fields" title="historydag.HistoryDag.remove_label_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_label_fields</span></code></a>([fields_to_remove])</p></td>
<td><p>Returns a copy of the DAG with the list of <cite>fields_to_remove</cite> dropped from each node's label.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.sample" title="historydag.HistoryDag.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>([edge_selector, log_probabilities])</p></td>
<td><p>Samples a history from the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.sample_with_edge" title="historydag.HistoryDag.sample_with_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_with_edge</span></code></a>(edge)</p></td>
<td><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">edge</span></code> (a tuple of HistoryDagNodes) from the history DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.sample_with_node" title="historydag.HistoryDag.sample_with_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_with_node</span></code></a>(node)</p></td>
<td><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">node</span></code> from the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">serialize</span></code>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a></span></p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.shared_history_count" title="historydag.HistoryDag.shared_history_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shared_history_count</span></code></a>(reference_dag[, key])</p></td>
<td><p>Count the histories which are also contained in <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.sum_probability" title="historydag.HistoryDag.sum_probability"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_probability</span></code></a>([log_probabilities])</p></td>
<td><p>Compute the total probability of all histories in the DAG, using downward conditional edge probabilities.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.sum_rf_distances" title="historydag.HistoryDag.sum_rf_distances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_rf_distances</span></code></a>([reference_dag, rooted, ...])</p></td>
<td><p>Computes the sum of Robinson-Foulds distances over all pairs of histories in this DAG and the provided reference DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.sum_weights" title="historydag.HistoryDag.sum_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_weights</span></code></a>([edge_weight_func])</p></td>
<td><p>For weights which are a sum over edges, compute the sum of all tree weights in the DAG.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.summary" title="historydag.HistoryDag.summary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary</span></code></a>()</p></td>
<td><p>Print summary info about the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.to_ascii" title="historydag.HistoryDag.to_ascii"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_ascii</span></code></a>(name_func, **kwargs)</p></td>
<td><p>A convenience function that uses the <a class="reference internal" href="#historydag.HistoryDag.to_ete" title="historydag.HistoryDag.to_ete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_ete()</span></code></a> method and ete3's ASCII drawing tools to render a history.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.to_ete" title="historydag.HistoryDag.to_ete"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_ete</span></code></a>([name_func, features, feature_funcs])</p></td>
<td><p>Convert a history DAG which is a history to an ete tree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.to_graphviz" title="historydag.HistoryDag.to_graphviz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_graphviz</span></code></a>([labelfunc, namedict, ...])</p></td>
<td><p>Converts history DAG to graphviz (dot format) Digraph object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.to_newick" title="historydag.HistoryDag.to_newick"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_newick</span></code></a>([name_func, features, feature_funcs])</p></td>
<td><p>Converts a history to extended newick format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.to_newicks" title="historydag.HistoryDag.to_newicks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_newicks</span></code></a>(**kwargs)</p></td>
<td><p>Returns a list of extended newick strings formed with label fields.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.trim_below_weight" title="historydag.HistoryDag.trim_below_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_below_weight</span></code></a>(max_weight[, start_func, ...])</p></td>
<td><p>Trim the dag to contain at least all the histories within the specified weight range.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_rf_distance" title="historydag.HistoryDag.trim_optimal_rf_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_optimal_rf_distance</span></code></a>(history[, rooted, ...])</p></td>
<td><p>Trims this history DAG to the optimal (min or max) RF distance to a given history.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_sum_rf_distance" title="historydag.HistoryDag.trim_optimal_sum_rf_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_optimal_sum_rf_distance</span></code></a>(reference_dag)</p></td>
<td><p>Trims the DAG to contain only histories with the optimal (min or max) sum rooted RF distance to the given reference DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.trim_optimal_weight" title="historydag.HistoryDag.trim_optimal_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_optimal_weight</span></code></a>([start_func, ...])</p></td>
<td><p>Trims the DAG to only express trees with optimal weight.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.trim_topology" title="historydag.HistoryDag.trim_topology"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_topology</span></code></a>(topology[, collapse_leaves])</p></td>
<td><p>Trims the history DAG to express only trees matching the provided topology.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim_within_range</span></code>([min_weight, max_weight, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.underestimate_rf_diameter" title="historydag.HistoryDag.underestimate_rf_diameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">underestimate_rf_diameter</span></code></a>()</p></td>
<td><p>Returns an underestimate of the RF diameter of the DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.uniform_distribution_annotate" title="historydag.HistoryDag.uniform_distribution_annotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uniform_distribution_annotate</span></code></a>([...])</p></td>
<td><p>Adjust edge probabilities so that the DAG expresses a uniform distribution on expressed trees.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.unlabel" title="historydag.HistoryDag.unlabel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unlabel</span></code></a>()</p></td>
<td><p>Sets all internal node labels to be identical, and merges nodes so that all histories in the DAG have unique topologies.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.update_label_fields" title="historydag.HistoryDag.update_label_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_label_fields</span></code></a>(field_names, ...)</p></td>
<td><p>Changes label field values to values returned by the function new_field_values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.weight_count" title="historydag.HistoryDag.weight_count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weight_count</span></code></a>([start_func, edge_weight_func, ...])</p></td>
<td><p>A template method for counting weights of trees expressed in the history DAG.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.HistoryDag.weight_counts_with_ambiguities" title="historydag.HistoryDag.weight_counts_with_ambiguities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weight_counts_with_ambiguities</span></code></a>([start_func, ...])</p></td>
<td><p>Template method for counting tree weights in the DAG, with exploded labels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.HistoryDag.weight_range_annotate" title="historydag.HistoryDag.weight_range_annotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weight_range_annotate</span></code></a>([start_func, ...])</p></td>
<td><p>Computes the minimum and maximum weight of any history in the history DAG.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.from_history_dag">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_history_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.from_history_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.from_history_dag" title="Link to this definition"></a></dt>
<dd><p>Converts HistoryDag instances between subclasses of HistoryDag. No
copy is performed, so the passed <cite>dag</cite> will in general be modified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dag</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span>) – A HistoryDag (or subclass) instance</p></li>
<li><p><strong>label_fields</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A list specifying the order of label fields in node labels on the resulting HistoryDag</p></li>
<li><p><strong>kwargs</strong> – Any additional arguments required for label conversions. For details, see the class docstring
for the subclass into which the conversion is taking place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The converted HistoryDag object, carrying the type from which this static method was called.
After conversion to the new HistoryDag subclass <code class="docutils literal notranslate"><span class="pre">to_cls</span></code>, the following will be true about node labels:</p>
<ul class="simple">
<li><p>If passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> is None, then existing label fields will be preserved, except that missing
required label fields will be recovered if possible, and the existing label fields used to recover
them will be omitted. Recovered label fields will appear before the existing label fields.</p></li>
<li><p>If passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> is not None, then it must include all fields expected in node labels
in the converted history DAG object, otherwise an exception will be raised.</p></li>
<li><p>Converted node label field order will match the order of passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code>.</p></li>
<li><p>All label fields passed in <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> will be included
in converted node labels, if possible. Otherwise, an exception will be raised.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dagroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_label_type">
<span class="sig-name descname"><span class="pre">get_label_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_label_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_label_type" title="Link to this definition"></a></dt>
<dd><p>Return the type for labels on this dag’s nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.trim_below_weight">
<span class="sig-name descname"><span class="pre">trim_below_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_possible_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_below_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.trim_below_weight" title="Link to this definition"></a></dt>
<dd><p>Trim the dag to contain at least all the histories within the
specified weight range.</p>
<p>Supports totally ordered weights, accumulated by addition. A
weight type must implement all ordering operators properly, as
well as + and -, and addition and subtraction must respect the
ordering. That is, if a &lt; b, then a + c &lt; b + c for any c
(including negative c)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_histories">
<span class="sig-name descname"><span class="pre">get_histories</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_histories" title="Link to this definition"></a></dt>
<dd><p>Return a generator containing all histories in the history DAG.</p>
<p>Note that each history is a tree-shaped history DAG, containing a UA node,
which exists as a subgraph of the history DAG.</p>
<p>The order of these histories does not necessarily match the order of
indexing. That is, <code class="docutils literal notranslate"><span class="pre">dag.get_histories()</span></code> and <code class="docutils literal notranslate"><span class="pre">history</span> <span class="pre">for</span> <span class="pre">history</span> <span class="pre">in</span>
<span class="pre">dag</span></code> will result in different orderings. <code class="docutils literal notranslate"><span class="pre">get_histories</span></code> should
be slightly faster, but possibly more memory intensive.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_trees">
<span class="sig-name descname"><span class="pre">get_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_trees" title="Link to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.get_histories" title="historydag.HistoryDag.get_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_histories()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_leaves">
<span class="sig-name descname"><span class="pre">get_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_leaves" title="Link to this definition"></a></dt>
<dd><p>Return a generator containing all leaf nodes in the history DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_edges">
<span class="sig-name descname"><span class="pre">get_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_edges" title="Link to this definition"></a></dt>
<dd><p>Return a generator containing all edges in the history DAG, as
parent, child node tuples.</p>
<p>Edges’ parent nodes will be in preorder.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_annotated_edges">
<span class="sig-name descname"><span class="pre">get_annotated_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_annotated_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_annotated_edges" title="Link to this definition"></a></dt>
<dd><p>Return a generator containing all edges in the history DAG, and
their weights and downward conditional edge probabilities.</p>
<p>Yields ((parent, child), weight, probability) for each edge.</p>
<p>Edges’ parent nodes will be in preorder.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.num_edges">
<span class="sig-name descname"><span class="pre">num_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.num_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.num_edges" title="Link to this definition"></a></dt>
<dd><p>Return the number of edges in the DAG, including edges descending
from the UA node, unless skip_ua_node is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.num_nodes">
<span class="sig-name descname"><span class="pre">num_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.num_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.num_nodes" title="Link to this definition"></a></dt>
<dd><p>Return the number of nodes in the DAG, not counting the UA node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.num_leaves">
<span class="sig-name descname"><span class="pre">num_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.num_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.num_leaves" title="Link to this definition"></a></dt>
<dd><p>Return the number of leaf nodes in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.find_nodes">
<span class="sig-name descname"><span class="pre">find_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.find_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.find_nodes" title="Link to this definition"></a></dt>
<dd><p>Return a generator on (non-UA) nodes for which <code class="docutils literal notranslate"><span class="pre">filter_func</span></code>
evaluates to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.find_node">
<span class="sig-name descname"><span class="pre">find_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.find_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.find_node" title="Link to this definition"></a></dt>
<dd><p>Return the first (non-UA) node for which <code class="docutils literal notranslate"><span class="pre">filter_func</span></code> evaluates
to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sample" title="Link to this definition"></a></dt>
<dd><p>Samples a history from the history DAG. (A history is a sub-history
DAG containing the root and all leaf nodes) For reproducibility, set
<code class="docutils literal notranslate"><span class="pre">random.seed</span></code> before sampling.</p>
<p>When there is an option, edges pointing to nodes on which <cite>selection_func</cite> is True
will always be chosen.</p>
<p>Returns a new HistoryDag object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.nodes_above_node">
<span class="sig-name descname"><span class="pre">nodes_above_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.nodes_above_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.nodes_above_node" title="Link to this definition"></a></dt>
<dd><p>Return a set of nodes from which the passed node is reachable along
directed edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Set" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Set</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sample_with_node">
<span class="sig-name descname"><span class="pre">sample_with_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample_with_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sample_with_node" title="Link to this definition"></a></dt>
<dd><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">node</span></code> from the history DAG.</p>
<p>Sampling is likely unbiased from the distribution of trees in
the DAG, conditioned on each sampled tree containing the passed
node. However, if unbiased sampling from the conditional
distribution is important, this should be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sample_with_edge">
<span class="sig-name descname"><span class="pre">sample_with_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample_with_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sample_with_edge" title="Link to this definition"></a></dt>
<dd><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">edge</span></code> (a tuple of
HistoryDagNodes) from the history DAG.</p>
<p>Sampling is likely unbiased from the distribution of trees in
the DAG, conditioned on each sampled tree containing the passed
edge. However, if unbiased sampling from the conditional
distribution is important, this should be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.iter_covering_histories">
<span class="sig-name descname"><span class="pre">iter_covering_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cover_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.iter_covering_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.iter_covering_histories" title="Link to this definition"></a></dt>
<dd><p>Samples a sequence of histories which together contain all nodes in
the history DAG.</p>
<p>Histories are sampled using <a class="reference internal" href="#historydag.HistoryDag.sample_with_node" title="historydag.HistoryDag.sample_with_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_with_node()</span></code></a>, starting
with the nodes which are contained in the fewest of the DAG’s
histories. The sequence of trees is therefore non-deterministic
unless <code class="docutils literal notranslate"><span class="pre">random.seed</span></code> is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.unlabel">
<span class="sig-name descname"><span class="pre">unlabel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.unlabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.unlabel" title="Link to this definition"></a></dt>
<dd><p>Sets all internal node labels to be identical, and merges nodes so
that all histories in the DAG have unique topologies.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.relabel">
<span class="sig-name descname"><span class="pre">relabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relabel_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.relabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.relabel" title="Link to this definition"></a></dt>
<dd><p>Return a new HistoryDag with labels modified according to a provided
function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relabel_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]</span>) – A function which takes a node and returns the new label
appropriate for that node. The relabel_func should return a consistent
NamedTuple type with name Label. That is, all returned labels
should have matching <cite>_fields</cite> attribute.
Method is only guaranteed to work when no two leaf nodes are
mapped to the same new label. If this is not the case, this method may
raise a warning or error, or may fail silently, returning an invalid
HistoryDag.</p></li>
<li><p><strong>relax_type</strong> – Whether to require the returned HistoryDag to be of the same subclass as self.
If True, the returned HistoryDag will be of the abstract type <cite>HistoryDag</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.add_label_fields">
<span class="sig-name descname"><span class="pre">add_label_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_field_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_field_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.add_label_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.add_label_fields" title="Link to this definition"></a></dt>
<dd><p>Returns a copy of the DAG in which each node’s label is extended to
include the new fields listed in <cite>new_field_names</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_field_names</strong> – A list of strings consisting of the names of the new fields to add.</p></li>
<li><p><strong>new_field_values</strong> – A callable that takes a node and returns the ordered list
of values for each new field name to assign to that node.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.remove_label_fields">
<span class="sig-name descname"><span class="pre">remove_label_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields_to_remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.remove_label_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.remove_label_fields" title="Link to this definition"></a></dt>
<dd><p>Returns a copy of the DAG with the list of <cite>fields_to_remove</cite>
dropped from each node’s label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fields_to_remove</strong> – A list of strings consisting of the names of the new fields to remove.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.update_label_fields">
<span class="sig-name descname"><span class="pre">update_label_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_field_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.update_label_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.update_label_fields" title="Link to this definition"></a></dt>
<dd><p>Changes label field values to values returned by the function
new_field_values. This method is not in-place, but returns a new DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_names</strong> – A list of strings containing names of label fields whose contents are to be modified</p></li>
<li><p><strong>new_field_values</strong> – A function taking a node and returning a tuple of field values whose order matches field_names</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.is_history">
<span class="sig-name descname"><span class="pre">is_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.is_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.is_history" title="Link to this definition"></a></dt>
<dd><p>Returns whether history DAG is a history.</p>
<p>That is, each node-clade pair has exactly one descendant edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.is_clade_tree">
<span class="sig-name descname"><span class="pre">is_clade_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.is_clade_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.is_clade_tree" title="Link to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.is_history" title="historydag.HistoryDag.is_history"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_history()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.copy" title="Link to this definition"></a></dt>
<dd><p>Uses bytestring serialization, and is guaranteed to copy:
:rtype: <span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span></p>
<ul class="simple">
<li><p>node labels</p></li>
<li><p>node attr attributes</p></li>
<li><p>edge weights</p></li>
<li><p>edge probabilities</p></li>
</ul>
<p>However, other object attributes will not be copied.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.history_intersect">
<span class="sig-name descname"><span class="pre">history_intersect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.history_intersect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.history_intersect" title="Link to this definition"></a></dt>
<dd><p>Modify this HistoryDag to contain only the histories which are also
contained in <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_dag</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span>) – The history DAG with which this one will be intersected. <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>
will not be modified.</p></li>
<li><p><strong>key</strong> – A function accepting a node and returning a value which will be used to compare
nodes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.shared_history_count">
<span class="sig-name descname"><span class="pre">shared_history_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.shared_history_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.shared_history_count" title="Link to this definition"></a></dt>
<dd><p>Count the histories which are also contained in <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_dag</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></span>) – The history DAG with which this one will be intersected. <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>
will not be modified.</p></li>
<li><p><strong>key</strong> – A function accepting a node and returning a value which will be used to compare
nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of histories shared between this history DAG and the reference.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trees</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.merge" title="Link to this definition"></a></dt>
<dd><p>Graph union this history DAG with all those in a list of history
DAGs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.add_all_allowed_edges">
<span class="sig-name descname"><span class="pre">add_all_allowed_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.add_all_allowed_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.add_all_allowed_edges" title="Link to this definition"></a></dt>
<dd><p>Provided as a deprecated synonym for <a class="reference internal" href="#historydag.HistoryDag.make_complete" title="historydag.HistoryDag.make_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_complete()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.make_complete">
<span class="sig-name descname"><span class="pre">make_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_from_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjacent_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_parent_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.make_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.make_complete" title="Link to this definition"></a></dt>
<dd><p>Add all allowed edges to the DAG in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_from_root</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If False, no edges will be added that start at the DAG root.
Useful when attempting to constrain root label.</p></li>
<li><p><strong>adjacent_labels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If False, no edges will be added between nodes with the same
labels. Useful when attempting to maintain the history DAG in a ‘collapsed’
state.</p></li>
<li><p><strong>preserve_parent_labels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If True, ensures that for any edge added between a
parent and child node, the parent node label was already among the original
parent labels of the child node. This ensures that parsimony score is preserved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of edges added to the history DAG</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.to_newick">
<span class="sig-name descname"><span class="pre">to_newick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_funcs={}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_newick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.to_newick" title="Link to this definition"></a></dt>
<dd><p>Converts a history to extended newick format. Supports arbitrary
node names and a sequence feature. For use on a history DAG which is a
history.</p>
<p>For extracting newick representations of trees in a general history DAG, see
<a class="reference internal" href="#historydag.HistoryDag.to_newicks" title="historydag.HistoryDag.to_newicks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – A map from nodes to newick node names</p></li>
<li><p><strong>features</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A list of label field names to be included in extended newick data.
If <cite>None</cite>, all label fields will be included. To include none of them,
pass an empty list.</p></li>
<li><p><strong>feature_funcs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A dictionary keyed by extended newick field names, containing
functions specifying how to populate that field for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A newick string. If <cite>features</cite> is an empty list, and feature_funcs is empty,</dt><dd><p>then this will be a standard newick string. Otherwise, it will have ete3’s
extended newick format.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.to_ascii">
<span class="sig-name descname"><span class="pre">to_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_ascii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.to_ascii" title="Link to this definition"></a></dt>
<dd><p>A convenience function that uses the <a class="reference internal" href="#historydag.HistoryDag.to_ete" title="historydag.HistoryDag.to_ete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_ete()</span></code></a> method and
ete3’s ASCII drawing tools to render a history.</p>
<p>See <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode.to_ascii" title="historydag.HistoryDagNode.to_ascii"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDagNode.to_ascii()</span></code></a> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.to_ete">
<span class="sig-name descname"><span class="pre">to_ete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_funcs={}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_ete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.to_ete" title="Link to this definition"></a></dt>
<dd><p>Convert a history DAG which is a history to an ete tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – A map from nodes to newick node names</p></li>
<li><p><strong>features</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A list of label field names to be included in extended newick data.
If <cite>None</cite>, all label fields will be included. To include none of them,
pass an empty list.</p></li>
<li><p><strong>feature_funcs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A dictionary keyed by extended newick field names, containing
functions specifying how to populate that field for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An ete3 Tree with the same topology as self, and node names and attributes
as specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.to_graphviz">
<span class="sig-name descname"><span class="pre">to_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labelfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namedict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_child_clades</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_partitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_attr_inheritance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_edge_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_edge_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.to_graphviz" title="Link to this definition"></a></dt>
<dd><p>Converts history DAG to graphviz (dot format) Digraph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labelfunc</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</span>) – A function to label nodes. If None, nodes will be labeled by
their DAG node labels, or their label hash if label data is too large.</p></li>
<li><p><strong>namedict</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – A dictionary from node labels to label strings. Labelfunc will be
used instead, if both are provided.</p></li>
<li><p><strong>show_child_clades</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to include child clades in output.</p></li>
<li><p><strong>show_partitions</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]</span>) – Deprecated alias for show_child_clades.</p></li>
<li><p><strong>level_leaves</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to draw leaves on the same level, or wherever they fall naturally.</p></li>
<li><p><strong>graph_attr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Additional graphviz graph attributes (see graphviz docs)</p></li>
<li><p><strong>node_attr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Additional graphviz node attributes (see graphviz docs)</p></li>
<li><p><strong>edge_attr</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span>) – Additional graphviz edge attributes (see graphviz docs)</p></li>
<li><p><strong>edge_attr_inheritance</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – “parent” to inherit from parent node, “child” to inherit from child, or “none”.</p></li>
<li><p><strong>show_edge_probs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – whether to show edge probabilities</p></li>
<li><p><strong>show_edge_weights</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – whether to show edge weights</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Digraph</span></code></span></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Graphviz dot format attributes are documented at <a class="reference external" href="https://graphviz.org/doc/info/attrs.html">https://graphviz.org/doc/info/attrs.html</a>
The graphviz attributes passed to this method are for the entire graph. Attributes for
individual nodes can be included in individual node attr dictionaries under the key <code class="docutils literal notranslate"><span class="pre">gv_attrs</span></code>.
For example, <code class="docutils literal notranslate"><span class="pre">node.attr['gv_attrs']</span> <span class="pre">=</span> <span class="pre">{'color':</span> <span class="pre">'red'}</span></code> will color a node red in the graphviz
output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.internal_avg_parents">
<span class="sig-name descname"><span class="pre">internal_avg_parents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.internal_avg_parents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.internal_avg_parents" title="Link to this definition"></a></dt>
<dd><p>Returns the average number of parents among internal nodes.</p>
<p>A simple measure of similarity between the trees that the DAG
expresses. However, keep in mind that two trees with the same
topology but different labels would be considered entirely
unalike by this measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.explode_nodes">
<span class="sig-name descname"><span class="pre">explode_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">parsimony_utils.default_nt_transitions.ambiguity_map.get_sequence_resolution_func('sequence')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_node_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expandable_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.explode_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.explode_nodes" title="Link to this definition"></a></dt>
<dd><p>Explode nodes according to a provided function. Adds copies of each
node to the DAG with exploded labels, but with the same parents and
children as the original node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expand_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]</span>) – (Deprecated) A function that takes a node label, and returns an iterable
containing ‘exploded’ or ‘disambiguated’ labels corresponding to the original.
The wrapper <a class="reference internal" href="historydag.utils.html#historydag.utils.explode_label" title="historydag.utils.explode_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.explode_label()</span></code></a> is provided to make such a function
easy to write.</p></li>
<li><p><strong>expand_node_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]</span>) – A function that takes a node and returns an iterable
containing ‘exploded’ or ‘disambiguated’ labels corresponding to the
node. If provided, expand_func will be ignored.</p></li>
<li><p><strong>expandable_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]]</span>) – A function that takes a node label, and returns whether the
iterable returned by calling expand_func on that label would contain more
than one item.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of new nodes added to the history DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.leaf_path_uncertainty_dag">
<span class="sig-name descname"><span class="pre">leaf_path_uncertainty_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.leaf_path_uncertainty_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.leaf_path_uncertainty_dag" title="Link to this definition"></a></dt>
<dd><p>Create a DAG of possible paths leading to <cite>terminal_node</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The returned path DAG will contain all paths from the
UA node ending at this node.</p></li>
<li><p><strong>node_data_func</strong> – A function accepting a HistoryDagNode and returning
data for the corresponding node in the path dag. Return type must
be a valid dictionary key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary keyed by return values of
<cite>node_data_func</cite>, with each value a dictionary keyed by child nodes,
with edge supports as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>child_dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.leaf_path_uncertainty_graphviz">
<span class="sig-name descname"><span class="pre">leaf_path_uncertainty_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_label_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.leaf_path_uncertainty_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.leaf_path_uncertainty_graphviz" title="Link to this definition"></a></dt>
<dd><p>Create a graphviz DAG of possible paths leading to <cite>terminal_node</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The returned path DAG will contain all paths from the
UA node ending at this node.</p></li>
<li><p><strong>node_data_func</strong> – A function accepting a HistoryDagNode and returning
data for the corresponding node in the path dag. Return type must
be a valid dictionary key.</p></li>
<li><p><strong>node_label_func</strong> – A function accepting an object of the type returned
by <cite>node_data_func</cite>, and returning a label to be displayed on the
corresponding node.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.summary" title="Link to this definition"></a></dt>
<dd><p>Print summary info about the history DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.label_uncertainty_summary">
<span class="sig-name descname"><span class="pre">label_uncertainty_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.label_uncertainty_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.label_uncertainty_summary" title="Link to this definition"></a></dt>
<dd><p>Print information about internal nodes which have the same child
clades but different labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.postorder_history_accum">
<span class="sig-name descname"><span class="pre">postorder_history_accum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_within_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_between_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_above_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_edge_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_edgeweights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_history_accum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.postorder_history_accum" title="Link to this definition"></a></dt>
<dd><p>A template method for leaf-to-root dynamic programming.</p>
<p>Intermediate computations are stored in a <cite>_dp_data</cite> attribute on each node.
Note that a <cite>Weight</cite> can be whatever you like, such as integers, Counters,
strings, or dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function to assign weights to leaf nodes</p></li>
<li><p><strong>edge_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function to assign weights to edges. The parent node will
always be the first argument.</p></li>
<li><p><strong>accum_within_clade</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which accumulates a list of weights of subtrees
below a single clade. That is, the weights are for alternative trees.</p></li>
<li><p><strong>accum_between_clade</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which accumulates a list of weights of subtrees
below different clades. That is, the weights are for different parts of the
same tree.</p></li>
<li><p><strong>accum_above_edge</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which adds the weight for a subtree to the weight
of the edge above it. If <cite>None</cite>, this function will be inferred from
<cite>accum_between_clade</cite>. The edge weight is the second argument.</p></li>
<li><p><strong>compute_edge_probabilities</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If True, compute downward-conditional edge probabilities,
proportional to aggregated subtree weights below and including each edge
descending from a node-clade pair.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The resulting weight computed for the History DAG UA (root) node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.postorder_cladetree_accum">
<span class="sig-name descname"><span class="pre">postorder_cladetree_accum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_cladetree_accum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.postorder_cladetree_accum" title="Link to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.postorder_history_accum" title="historydag.HistoryDag.postorder_history_accum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.postorder_history_accum()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.optimal_weight_annotate">
<span class="sig-name descname"><span class="pre">optimal_weight_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.optimal_weight_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.optimal_weight_annotate" title="Link to this definition"></a></dt>
<dd><p>A template method for finding the optimal tree weight in the DAG.
Dynamically annotates each node in the DAG with the optimal weight of a
clade sub-tree beneath it, so that the DAG root node is annotated with
the optimal weight of a history in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns starting weights to leaves.</p></li>
<li><p><strong>edge_weight_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns weights to DAG edges based on the
parent node and the child node, in that order.</p></li>
<li><p><strong>accum_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which takes a list of weights of different parts of a
tree, and returns a weight, like sum.</p></li>
<li><p><strong>optimal_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which takes a list of weights and returns the optimal
one, like min.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The optimal weight of a tree under the DAG UA node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_optimal_histories">
<span class="sig-name descname"><span class="pre">count_optimal_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_optimal_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_optimal_histories" title="Link to this definition"></a></dt>
<dd><p>Count the number of histories which would be left if the DAG were
trimmed.</p>
<p>That is, how many histories would be left if <a class="reference internal" href="#historydag.HistoryDag.trim_optimal_weight" title="historydag.HistoryDag.trim_optimal_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_weight()</span></code></a>
were called with the same arguments?</p>
<p>:param All arguments are the same as <a class="reference internal" href="#historydag.HistoryDag.trim_optimal_weight" title="historydag.HistoryDag.trim_optimal_weight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_weight()</span></code></a>.:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A <a class="reference internal" href="historydag.utils.html#historydag.utils.IntState" title="historydag.utils.IntState"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.IntState</span></code></a> object containing the number of optimal histories
in the DAG, with <code class="docutils literal notranslate"><span class="pre">state</span></code> attribute containing their (optimal) weight.</p>
<p>As a side-effect, each node’s <code class="docutils literal notranslate"><span class="pre">_dp_data</span></code> attribute is populated with
IntState objects containing the number of optimal sub-histories rooted at that
node, and the weight of those sub-histories.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sum_weights">
<span class="sig-name descname"><span class="pre">sum_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sum_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sum_weights" title="Link to this definition"></a></dt>
<dd><p>For weights which are a sum over edges, compute the sum of all tree
weights in the DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.weight_count">
<span class="sig-name descname"><span class="pre">weight_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.weight_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.weight_count" title="Link to this definition"></a></dt>
<dd><p>A template method for counting weights of trees expressed in the
history DAG.</p>
<p>Weights must be hashable, but may otherwise be of arbitrary type.</p>
<p>Default arguments are contained in this HistoryDag subclass’s _default_args
variable, and are documented in the subclass docstring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns a weight to each leaf node</p></li>
<li><p><strong>edge_weight_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns a weight to pairs of labels, with the
parent node label the first argument</p></li>
<li><p><strong>accum_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A way to ‘add’ a list of weights together</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Counter keyed by weights.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.weight_range_annotate">
<span class="sig-name descname"><span class="pre">weight_range_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_func=&lt;built-in</span> <span class="pre">function</span> <span class="pre">min&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_func=&lt;built-in</span> <span class="pre">function</span> <span class="pre">max&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.weight_range_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.weight_range_annotate" title="Link to this definition"></a></dt>
<dd><p>Computes the minimum and maximum weight of any history in the
history DAG.</p>
<p>As a side-effect, this method also stores in each node’s <code class="docutils literal notranslate"><span class="pre">_dp_data</span></code> attribute
a tuple containing the minimum and maximum weights of any sub-history beneath that node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns a weight to each leaf node</p></li>
<li><p><strong>edge__weight_func</strong> – A function which assigns a weight to pairs of labels, with the
parent node label the first argument</p></li>
<li><p><strong>accum_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A way to ‘add’ a list of weights together</p></li>
<li><p><strong>min_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which takes a list of weights and returns their “minimum”</p></li>
<li><p><strong>max_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which takes a list of weights and returns their “maximum”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the minimum and maximum weight of any history in the history DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.hamming_parsimony_count">
<span class="sig-name descname"><span class="pre">hamming_parsimony_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.hamming_parsimony_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.hamming_parsimony_count" title="Link to this definition"></a></dt>
<dd><p>Deprecated in favor of
<a class="reference internal" href="historydag.sequence_dag.html#historydag.sequence_dag.SequenceHistoryDag.hamming_parsimony_count" title="historydag.sequence_dag.SequenceHistoryDag.hamming_parsimony_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sequence_dag.SequenceHistoryDag.hamming_parsimony_count()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.to_newicks">
<span class="sig-name descname"><span class="pre">to_newicks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_newicks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.to_newicks" title="Link to this definition"></a></dt>
<dd><p>Returns a list of extended newick strings formed with label fields.</p>
<p>Arguments are passed to <a class="reference internal" href="historydag.utils.html#historydag.utils.make_newickcountfuncs" title="historydag.utils.make_newickcountfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_newickcountfuncs()</span></code></a>.
Arguments are the same as for
<a class="reference internal" href="#historydag.HistoryDag.to_newick" title="historydag.HistoryDag.to_newick"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.HistoryDag.to_newick()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_topologies">
<span class="sig-name descname"><span class="pre">count_topologies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_topologies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_topologies" title="Link to this definition"></a></dt>
<dd><p>Counts the number of unique topologies in the history DAG. This is
achieved by counting the number of unique newick strings with only
leaves labeled.</p>
<p><a class="reference internal" href="#historydag.HistoryDag.count_histories" title="historydag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_histories()</span></code></a> gives the total number of unique trees in the DAG, taking
into account internal node labels.</p>
<p>For large DAGs, this method is prohibitively slow. Use <a class="reference internal" href="#historydag.HistoryDag.count_topologies_fast" title="historydag.HistoryDag.count_topologies_fast"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_topologies_fast()</span></code></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>collapse_leaves</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – By default, topologies are counted as-is in the DAG. However,
even if the DAG is collapsed by label, edges above leaf nodes will not be collapsed.
if <cite>collapse_leaves</cite> is True, then the number of unique topologies with all
leaf-adjacent edges collapsed will be counted. Assumes that the DAG is collapsed
with <a class="reference internal" href="#historydag.HistoryDag.convert_to_collapsed" title="historydag.HistoryDag.convert_to_collapsed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.convert_to_collapsed()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of topologies in the history DAG</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_topologies_fast">
<span class="sig-name descname"><span class="pre">count_topologies_fast</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_topologies_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_topologies_fast" title="Link to this definition"></a></dt>
<dd><p>Counts the number of unique topologies in the history DAG.</p>
<p>This is achieved by creating a new history DAG in which all
internal nodes have matching labels.</p>
<p>This is only guaranteed to match the output of <code class="docutils literal notranslate"><span class="pre">count_topologies</span></code>
if the DAG has all allowed edges added.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_trees">
<span class="sig-name descname"><span class="pre">count_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_trees" title="Link to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.HistoryDag.count_histories" title="historydag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_histories()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_histories">
<span class="sig-name descname"><span class="pre">count_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_count_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">ls:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bifurcating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_histories" title="Link to this definition"></a></dt>
<dd><p>Annotates each node in the DAG with the number of clade sub-trees
underneath.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expand_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]</span>) – A function which takes a label and returns a list of labels, for
example disambiguations of an ambiguous sequence. If provided, this method
will count at least the number of histories that would be in the DAG,
if <a class="reference internal" href="#historydag.HistoryDag.explode_nodes" title="historydag.HistoryDag.explode_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">explode_nodes()</span></code></a> were called with the same <cite>expand_func</cite>.</p></li>
<li><p><strong>expand_count_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – A function which takes a label and returns an integer value
corresponding to the number of ‘disambiguations’ of that label. If provided,
<cite>expand_func</cite> will be used to find this value.</p></li>
<li><p><strong>bifurcating</strong> – If True, the number of bifurcating topologies possible below each
node will be computed. This is only an underestimate of the true number, since
nodes that would be created by adding all resolutions of multifurcating nodes
may already be present, resulting in additional subtree swaps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of unique complete trees below the root node. If <cite>expand_func</cite>
or <cite>expand_count_func</cite> is provided, the complete trees being counted are not
guaranteed to be unique. If bifurcating is True, then the values stored in nodes’
<code class="docutils literal notranslate"><span class="pre">_dp_data</span></code> attributes will include all resolutions of multifurcations below a node,
but not of a node’s own multifurcation. To get the number of bifurcating subtrees below
a node, one can use <a href="#id1"><span class="problematic" id="id2">``</span></a>node._dp_data * utils.count_labeled_binary_topologies(len(node.clades)).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.preorder_history_accum">
<span class="sig-name descname"><span class="pre">preorder_history_accum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_within_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_between_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ua_start_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_above_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.preorder_history_accum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.preorder_history_accum" title="Link to this definition"></a></dt>
<dd><p>A template method for leaf-to-root and root-to-leaf dynamic
programming.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function to assign weights to leaf nodes</p></li>
<li><p><strong>edge_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function to assign weights to edges. The parent node will
always be the first argument.</p></li>
<li><p><strong>accum_within_clade</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which accumulates a list of weights of subtrees
below a single clade. That is, the weights are for alternative trees.</p></li>
<li><p><strong>accum_between_clade</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – A function which accumulates a list of weights of subtrees
below different clades. That is, the weights are for different parts of the
same tree.</p></li>
<li><p><strong>accum_above_edge</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which adds the weight for a subtree to the weight
of the edge above it. If <cite>None</cite>, this function will be inferred from
<cite>accum_between_clade</cite>. The edge weight is the second argument.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One describing downward weights below each node,
and another describing upward weights above each node</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Two dictionaries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_nodes">
<span class="sig-name descname"><span class="pre">count_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_nodes" title="Link to this definition"></a></dt>
<dd><p>Counts the number of trees each node takes part in.</p>
<p>For node supports with respect to a uniform distribution on trees, use
<a class="reference internal" href="#historydag.HistoryDag.uniform_distribution_annotate" title="historydag.HistoryDag.uniform_distribution_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.uniform_distribution_annotate()</span></code></a> and <a class="reference internal" href="#historydag.HistoryDag.node_probabilities" title="historydag.HistoryDag.node_probabilities"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.node_probabilities()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>collapse</strong> – A flag that when set to true, treats nodes as clade unions and
ignores label information. Then, the returned dictionary is keyed by
clade union sets.</p></li>
<li><p><strong>rooted</strong> – A flag which is ignored unless <code class="docutils literal notranslate"><span class="pre">collapse</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. When <code class="docutils literal notranslate"><span class="pre">rooted</span></code> is also <code class="docutils literal notranslate"><span class="pre">False</span></code>,
the returned dictionary is keyed by splits – that is, sets containing each clade
union and its complement, with values the number of (rooted) trees in the DAG containing
each split. Splits are not double-counted when a tree has a bifurcating root.
If False, dag is expected to have trees all on the same set of leaf labels.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary mapping each node in the DAG to the number of trees
that it takes part in.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_edges">
<span class="sig-name descname"><span class="pre">count_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_edges" title="Link to this definition"></a></dt>
<dd><p>Counts the number of trees each edge takes part in.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping each edge in the DAG to the number of trees
that it takes part in.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.most_supported_trees">
<span class="sig-name descname"><span class="pre">most_supported_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.most_supported_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.most_supported_trees" title="Link to this definition"></a></dt>
<dd><p>Trims the DAG to only express the trees that have the highest
support.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_paths_to_leaf">
<span class="sig-name descname"><span class="pre">count_paths_to_leaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_count_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">ls:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_paths_to_leaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_paths_to_leaf" title="Link to this definition"></a></dt>
<dd><p>Annotates each node in the DAG with the number of paths to
<code class="docutils literal notranslate"><span class="pre">leaf_label</span></code> underneath.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf_label</strong> – The label of the leaf node of interest</p></li>
<li><p><strong>expand_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]</span>) – A function which takes a label and returns a list of labels, for
example disambiguations of an ambiguous sequence. If provided, this method
will count at least the number of histories that would be in the DAG,
if <a class="reference internal" href="#historydag.HistoryDag.explode_nodes" title="historydag.HistoryDag.explode_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">explode_nodes()</span></code></a> were called with the same <cite>expand_func</cite>.</p></li>
<li><p><strong>expand_count_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – A function which takes a label and returns an integer value
corresponding to the number of ‘disambiguations’ of that label. If provided,
<cite>expand_func</cite> will be used to find this value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of unique paths to the leaf node of interest. If <cite>expand_func</cite>
or <cite>expand_count_func</cite> is provided, the paths being counted are not guaranteed
to be unique.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.weight_counts_with_ambiguities">
<span class="sig-name descname"><span class="pre">weight_counts_with_ambiguities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.weight_counts_with_ambiguities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.weight_counts_with_ambiguities" title="Link to this definition"></a></dt>
<dd><p>Template method for counting tree weights in the DAG, with exploded
labels. Like <a class="reference internal" href="#historydag.HistoryDag.weight_count" title="historydag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.weight_count()</span></code></a>, but creates dictionaries
of Counter objects at each node, keyed by possible sequences at that
node. Analogous to <a class="reference internal" href="#historydag.HistoryDag.count_histories" title="historydag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.count_histories()</span></code></a> with
<cite>expand_func</cite> provided.</p>
<p>Weights must be hashable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns a weight to each leaf node</p></li>
<li><p><strong>edge_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns a weight to pairs of labels, with the
parent node label the first argument. Must correctly handle the UA
node label which is a UALabel instead of a namedtuple.</p></li>
<li><p><strong>accum_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A way to ‘add’ a list of weights together</p></li>
<li><p><strong>expand_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]</span>) – A function which takes a label and returns a list of labels, such
as disambiguations of an ambiguous sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Counter keyed by weights.
The total number of trees will be greater than count_histories(), as these are
possible disambiguations of trees. These disambiguations may not be unique,
but if two are the same, they come from different subtrees of the DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.underestimate_rf_diameter">
<span class="sig-name descname"><span class="pre">underestimate_rf_diameter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.underestimate_rf_diameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.underestimate_rf_diameter" title="Link to this definition"></a></dt>
<dd><p>Returns an underestimate of the RF diameter of the DAG. This
estimate is calculated by calculating the maximal sum RF distance
between the DAG and a random tree from a topological outlier.</p>
<p>On a set of DAGs with 2000 or less histories, this underestimate
is quite accurate compared to the actual computed RF diameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.overestimate_rf_diameter">
<span class="sig-name descname"><span class="pre">overestimate_rf_diameter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.overestimate_rf_diameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.overestimate_rf_diameter" title="Link to this definition"></a></dt>
<dd><p>Returns an overestimate of the RF diameter of the DAG. This estimate
is calculated by calculating twice of the maximal sum RF distance
between the DAG and a random tree from the median tree.</p>
<p>On a set of DAGs with 2000 or less histories, this underestimate
was not close compared to the actual RF diameter. However, the
overestimate was never more than twice of the actual RF
diameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.optimal_sum_rf_distance">
<span class="sig-name descname"><span class="pre">optimal_sum_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.optimal_sum_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.optimal_sum_rf_distance" title="Link to this definition"></a></dt>
<dd><p>Returns the optimal (min or max) summed rooted RF distance to all
histories in the reference DAG.</p>
<p>The given history must be on the same taxa as all trees in the DAG.
Since computing reference splits is expensive, it is better to use
:meth:<code class="docutils literal notranslate"><span class="pre">optimal_weight_annotate</span></code> and :meth:<code class="docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs</span></code>
instead of making multiple calls to this method with the same reference
history DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.trim_optimal_sum_rf_distance">
<span class="sig-name descname"><span class="pre">trim_optimal_sum_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_optimal_sum_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.trim_optimal_sum_rf_distance" title="Link to this definition"></a></dt>
<dd><p>Trims the DAG to contain only histories with the optimal (min or
max) sum rooted RF distance to the given reference DAG.</p>
<p>See <a class="reference internal" href="historydag.utils.html#historydag.utils.sum_rfdistance_funcs" title="historydag.utils.sum_rfdistance_funcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.sum_rfdistance_funcs()</span></code></a> for detailed documentation of
arguments.</p>
<p>Trimming to the minimum sum RF distance is equivalent to finding ‘median’ topologies,
and trimming to maximum sum rf distance is equivalent to finding topological outliers.</p>
<p>The given history must be on the same taxa as all trees in the DAG.
Since computing reference splits is expensive, it is better to use
:meth:<code class="docutils literal notranslate"><span class="pre">trim_optimal_weight</span></code> and :meth:<code class="docutils literal notranslate"><span class="pre">utils.sum_rfdistance_funcs</span></code>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.trim_optimal_rf_distance">
<span class="sig-name descname"><span class="pre">trim_optimal_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_optimal_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.trim_optimal_rf_distance" title="Link to this definition"></a></dt>
<dd><p>Trims this history DAG to the optimal (min or max) RF distance to a
given history.</p>
<p>See <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a> for detailed documentation of
arguments.</p>
<p>Also returns that optimal RF distance</p>
<p>The given history must be on the same taxa as all trees in the DAG.
Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optimal_weight_annotate()</span></code></a> and <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.optimal_rf_distance">
<span class="sig-name descname"><span class="pre">optimal_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.optimal_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.optimal_rf_distance" title="Link to this definition"></a></dt>
<dd><p>Returns the optimal (min or max) RF distance to a given history.</p>
<p>See <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a> for detailed documentation of
arguments.</p>
<p>The given history must be on the same taxa as all trees in the DAG.
Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optimal_weight_annotate()</span></code></a> and <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_rf_distances">
<span class="sig-name descname"><span class="pre">count_rf_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_rf_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_rf_distances" title="Link to this definition"></a></dt>
<dd><p>Returns a Counter containing all RF distances to a given history.</p>
<p>The given history must be on the same taxa as all trees in the DAG.</p>
<p>See <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a> for detailed documentation of
arguments.</p>
<p>Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.HistoryDag.weight_count" title="historydag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">weight_count()</span></code></a> and <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.count_sum_rf_distances">
<span class="sig-name descname"><span class="pre">count_sum_rf_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_sum_rf_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.count_sum_rf_distances" title="Link to this definition"></a></dt>
<dd><p>Returns a Counter containing all sum RF distances to a given
reference DAG.</p>
<p>See <a class="reference internal" href="historydag.utils.html#historydag.utils.sum_rfdistance_funcs" title="historydag.utils.sum_rfdistance_funcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.sum_rfdistance_funcs()</span></code></a> for detailed documentation of
arguments.</p>
<p>The given history DAG must be on the same taxa as all trees in the DAG.</p>
<p>Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.HistoryDag.weight_count" title="historydag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">weight_count()</span></code></a> and <a class="reference internal" href="historydag.utils.html#historydag.utils.sum_rfdistance_funcs" title="historydag.utils.sum_rfdistance_funcs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.sum_rfdistance_funcs()</span></code></a>
instead of making multiple calls to this method with the same reference
history DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sum_rf_distances">
<span class="sig-name descname"><span class="pre">sum_rf_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_sided_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sum_rf_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sum_rf_distances" title="Link to this definition"></a></dt>
<dd><p>Computes the sum of Robinson-Foulds distances over all pairs of
histories in this DAG and the provided reference DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_dag</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>]</span>) – If None, the sum of pairwise distances between histories in this DAG
is computed. If provided, the sum is over pairs containing one history in this DAG and
one from <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>.</p></li>
<li><p><strong>rooted</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If False, use edges’ splits for RF distance computation. Otherwise, use
the clade below each edge.</p></li>
<li><p><strong>one_sided</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span>) – May be ‘left’, ‘right’, or None. ‘left’ means that we count
splits (or clades, in the rooted case) which are in the reference trees but not
in the DAG tree, especially useful if trees in the DAG might be resolutions of
multifurcating trees in the reference DAG. ‘right’ means that we count splits or clades in
the DAG tree which are not in the reference trees, useful if the reference trees
are possibly resolutions of multifurcating trees in the DAG. If not None,
one_sided_coefficients are ignored.</p></li>
<li><p><strong>one_sided_coefficients</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – coefficients for non-standard symmetric difference calculations.
See <a class="reference internal" href="historydag.utils.html#historydag.utils.make_rfdistance_countfuncs" title="historydag.utils.make_rfdistance_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code></a> for more details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An integer sum of RF distances.</p>
</dd>
</dl>
<p>If T is the set of histories in the reference DAG, and T’ is the set of histories in
this DAG, then the returned sum is:</p>
<div class="math notranslate nohighlight">
\[\sum_{t\in T} \sum_{t'\in T'} d(t, t')\]</div>
<p>That is, since RF distance is symmetric, when T = T’ (such as when <code class="docutils literal notranslate"><span class="pre">reference_dag=None</span></code>),
or when the intersection of T and T’ is nonempty, some distances are counted twice.</p>
<p>Note that when computing one-sided distances, or when the one_sided_coefficients values are not
equal, this ‘distance’ is no longer symmetric.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.average_pairwise_rf_distance">
<span class="sig-name descname"><span class="pre">average_pairwise_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_dag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_identical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.average_pairwise_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.average_pairwise_rf_distance" title="Link to this definition"></a></dt>
<dd><p>Return the average Robinson-Foulds distance between pairs of
histories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_dag</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference internal" href="historydag.dag.html#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>]</span>) – A history DAG from which to take the second history in
each pair. If None, <code class="docutils literal notranslate"><span class="pre">self</span></code> will be used as the reference.</p></li>
<li><p><strong>non_identical</strong> – If True, mean divisor will be the number of non-identical pairs.</p></li>
<li><p><strong>kwargs</strong> – See <code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.sum_rf_distances()</span></code> for additional keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average rf-distance between pairs of histories, where the first history
comes from this DAG, and the second comes from <code class="docutils literal notranslate"><span class="pre">reference_dag</span></code>. The normalization
constant is the product of the number of histories in the two DAGs, unless
<code class="docutils literal notranslate"><span class="pre">non_identical</span></code> is True, in which case the number of histories which appear
in both DAGs is subtracted from this constant.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.trim_optimal_weight">
<span class="sig-name descname"><span class="pre">trim_optimal_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_optimal_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.trim_optimal_weight" title="Link to this definition"></a></dt>
<dd><p>Trims the DAG to only express trees with optimal weight. This is
guaranteed to be possible when edge_weight_func depends only on the
labels of an edge’s parent and child node.</p>
<p>Requires that weights are of a type that supports reliable equality
testing. In particular, floats are not recommended. Instead, consider
defining weights to be a precursor type, and define <cite>optimal_func</cite> to
choose the one whose corresponding float is maximized/minimized.</p>
<p>If floats must be used, a Numpy type may help.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns starting weights to leaves.</p></li>
<li><p><strong>edge_weight_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which assigns weights to DAG edges based on the
parent node and the child node, in that order.</p></li>
<li><p><strong>accum_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which takes a list of weights of different parts of a tree,
and returns a weight, like sum.</p></li>
<li><p><strong>optimal_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – A function which takes a list of weights and returns the optimal
one, like min.</p></li>
<li><p><strong>eq_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]</span>) – A function which tests equality, taking a pair of weights and returning a bool.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_topologies">
<span class="sig-name descname"><span class="pre">get_topologies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_topologies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_topologies" title="Link to this definition"></a></dt>
<dd><p>Return a list of pseudo-newick representations of topologies in the
history DAG.</p>
<p>The newicks returned are not well-formed, and are for use with
<a class="reference internal" href="#historydag.HistoryDag.trim_topology" title="historydag.HistoryDag.trim_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.trim_topology()</span></code></a>. Otherwise, this method would be equivalent to
<a class="reference internal" href="#historydag.HistoryDag.to_newicks" title="historydag.HistoryDag.to_newicks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a> with keyword arguments <code class="docutils literal notranslate"><span class="pre">internal_labels=False</span></code> and
<code class="docutils literal notranslate"><span class="pre">collapsed_leaves</span></code> as desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>collapse_leaves</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to collapse leaf-adjacent edges between nodes with
matching labels</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of strings, each representing a topology present in the history DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.trim_topology">
<span class="sig-name descname"><span class="pre">trim_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.trim_topology" title="Link to this definition"></a></dt>
<dd><p>Trims the history DAG to express only trees matching the provided
topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – A string like one output by <a class="reference internal" href="#historydag.HistoryDag.get_topologies" title="historydag.HistoryDag.get_topologies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a></p></li>
<li><p><strong>collapse_leaves</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – must match the same argument provided to <a class="reference internal" href="#historydag.HistoryDag.get_topologies" title="historydag.HistoryDag.get_topologies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a>
when creating the string passed as <code class="docutils literal notranslate"><span class="pre">topology</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.export_edge_probabilities">
<span class="sig-name descname"><span class="pre">export_edge_probabilities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.export_edge_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.export_edge_probabilities" title="Link to this definition"></a></dt>
<dd><p>Return a dictionary keyed by (parent, child) <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>
pairs, with downward conditional edge probabilities as values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.get_probability_countfuncs">
<span class="sig-name descname"><span class="pre">get_probability_countfuncs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_probability_countfuncs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.get_probability_countfuncs" title="Link to this definition"></a></dt>
<dd><p>Produce a <a class="reference internal" href="historydag.utils.html#historydag.utils.AddFuncDict" title="historydag.utils.AddFuncDict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.utils.AddFuncDict()</span></code></a> containing functions
to compute history probabilities using e.g.
<a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.optimal_weight_annotate()</span></code></a>.</p>
<p>If no edge probabilities are provided, a method like <a class="reference internal" href="#historydag.HistoryDag.probability_annotate" title="historydag.HistoryDag.probability_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.probability_annotate()</span></code></a>
should be called to set edge annotations correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probabilities</strong> – If True, interpret all edge probabilities as log-probabilities</p></li>
<li><p><strong>edge_probabilities</strong> – A dictionary containing conditional edge probabilities for each
edge in the DAG. If not provided, edge probabilities are recovered from edge
annotations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="historydag.utils.html#historydag.utils.AddFuncDict" title="historydag.utils.AddFuncDict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.utils.AddFuncDict()</span></code></a> containing functions to compute
history probabilities using e.g. <a class="reference internal" href="#historydag.HistoryDag.optimal_weight_annotate" title="historydag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.optimal_weight_annotate()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.sum_probability">
<span class="sig-name descname"><span class="pre">sum_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sum_probability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.sum_probability" title="Link to this definition"></a></dt>
<dd><p>Compute the total probability of all histories in the DAG, using
downward conditional edge probabilities.</p>
<p>Immediately after computing downward conditional probabilities, this should always return 1.</p>
<p>However, after trimming, this method returns the probability that a history in the trimmed
DAG would be sampled from the original DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probabilities</strong> – If True, interpret conditional edge probabilities as log-probabilities.
In this case, the return value is a log-probability as well.</p></li>
<li><p><strong>kwargs</strong> – The <a class="reference internal" href="historydag.utils.html#historydag.utils.AddFuncDict" title="historydag.utils.AddFuncDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">utils.AddFuncDict</span></code></a> containing keyword arguments for counting probabilities
returned from <a class="reference internal" href="#historydag.HistoryDag.get_probability_countfuncs" title="historydag.HistoryDag.get_probability_countfuncs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.get_probability_countfuncs()</span></code></a>. If not provided, conditional
edge probabilities annotated on the DAG will be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.node_probabilities">
<span class="sig-name descname"><span class="pre">node_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_edgeweights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ua_node_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.node_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.node_probabilities" title="Link to this definition"></a></dt>
<dd><p>Compute the probability of each node in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probabilities</strong> – If True, all probabilities, and the values from <code class="docutils literal notranslate"><span class="pre">edge_weight_func</span></code>, will
be treated as log values.</p></li>
<li><p><strong>edge_weight_func</strong> – A function accepting a parent node and a child node and returning the
weight associated to that edge. If not provided, it is assumed that correct edge probability
annotations are already populated by a method such as <a class="reference internal" href="#historydag.HistoryDag.probability_annotate" title="historydag.HistoryDag.probability_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.probability_annotate()</span></code></a>.</p></li>
<li><p><strong>normalize_edgeweights</strong> – A function taking a list of weights and returning a normalized list of
downward-conditional edge probabilities. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>accum_func</strong> – A function taking a list of probabilities for parts of a sub-history, and returning
a probability for that sub-history. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>aggregate_func</strong> – A function taking a list of probabilities for alternative sub-histories, and
returning the aggregated probability of all sub-histories. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>start_func</strong> – A function taking a leaf node and returning its starting weight. The default is
determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>ua_node_val</strong> – The probability value for the UA node. If not provided, the default value is
determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>collapse_key</strong> – A function accepting a <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a> and returning a key with respect
to which node probabilities should be collapsed. The return type is the key type for the
dictionary returned by this method. For example, to compute probabilities of each clade observed
in the DAG, use <code class="docutils literal notranslate"><span class="pre">collapse_key=HistoryDagNode.clade_union</span></code>.</p></li>
<li><p><strong>adjust_func</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]</span>) – A function accepting an edge, and returning a factor by which to adjust confidence in the
edge’s child node contributed by trees containing that edge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary keyed by <a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a> objects (or the return values of <code class="docutils literal notranslate"><span class="pre">collapse_key</span></code> if provided)
whose values are probabilities according to the distribution induced by downward-conditional edge
probabilities in the DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.probability_annotate">
<span class="sig-name descname"><span class="pre">probability_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_edgeweights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.probability_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.probability_annotate" title="Link to this definition"></a></dt>
<dd><p>Uses the supplied edge weight function to compute conditional
probabilities on edges.</p>
<p>Conditional probabilities are annotated on the DAG’s edges, so that future calls to e.g.
<a class="reference internal" href="#historydag.HistoryDag.sample" title="historydag.HistoryDag.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.sample()</span></code></a> use the probability distribution determined by them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_weight_func</strong> – A function accepting a parent node and a child node and returning the
weight associated to that edge.</p></li>
<li><p><strong>log_probabilities</strong> – If True, all probabilities, and the values from <code class="docutils literal notranslate"><span class="pre">edge_weight_func</span></code>, will
be treated as log values.</p></li>
<li><p><strong>normalize_edgeweights</strong> – A function taking a list of weights and returning a normalized list of
downward-conditional edge probabilities. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>accum_func</strong> – A function taking a list of probabilities for parts of a sub-history, and returning
a probability for that sub-history. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>aggregate_func</strong> – A function taking a list of probabilities for alternative sub-histories, and
returning the aggregated probability of all sub-histories. The default is determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
<li><p><strong>start_func</strong> – A function taking a leaf node and returning its starting weight. The default is
determined by <code class="docutils literal notranslate"><span class="pre">log_probabilities</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sum of un-normalized probabilities, according to the provided edge_weight_func. This value can be used
to normalize history probabilities computed with the same <code class="docutils literal notranslate"><span class="pre">edge_weight_func</span></code> provided to this method
(for example, weights returned by <a class="reference internal" href="#historydag.HistoryDag.weight_count" title="historydag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.weight_count()</span></code></a>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.natural_distribution_annotate">
<span class="sig-name descname"><span class="pre">natural_distribution_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.natural_distribution_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.natural_distribution_annotate" title="Link to this definition"></a></dt>
<dd><p>Set edge probabilities to 1/n, where n is the count of edges
descending from the corresponding node-clade pair.</p>
<p>This induces the ‘natural’ distribution on histories, determined
by the topology of the dag.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.uniform_distribution_annotate">
<span class="sig-name descname"><span class="pre">uniform_distribution_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.uniform_distribution_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.uniform_distribution_annotate" title="Link to this definition"></a></dt>
<dd><p>Adjust edge probabilities so that the DAG expresses a uniform
distribution on expressed trees.</p>
<p>The probability assigned to each edge below a clade is
proportional to the number of subtrees possible below that edge.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.make_uniform">
<span class="sig-name descname"><span class="pre">make_uniform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.make_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.make_uniform" title="Link to this definition"></a></dt>
<dd><p>Deprecated name for
<a class="reference internal" href="#historydag.HistoryDag.uniform_distribution_annotate" title="historydag.HistoryDag.uniform_distribution_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.uniform_distribution_annotate()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.recompute_parents">
<span class="sig-name descname"><span class="pre">recompute_parents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.recompute_parents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.recompute_parents" title="Link to this definition"></a></dt>
<dd><p>Repopulate <code class="docutils literal notranslate"><span class="pre">HistoryDagNode.parent</span></code> attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.convert_to_collapsed">
<span class="sig-name descname"><span class="pre">convert_to_collapsed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.convert_to_collapsed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.convert_to_collapsed" title="Link to this definition"></a></dt>
<dd><p>Rebuilds the DAG so that no edge connects two nodes with the same
label, unless one is a leaf node.</p>
<p>The resulting DAG should express at least the collapsed
histories present in the original.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.add_node_at_all_possible_places">
<span class="sig-name descname"><span class="pre">add_node_at_all_possible_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_leaf_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sequence'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.add_node_at_all_possible_places"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.add_node_at_all_possible_places" title="Link to this definition"></a></dt>
<dd><p>Inserts a sequence into the dag such that every tree in the dag now
contains that new node.</p>
<p>This method adds the new node as a leaf node by connecting it as
a child of every non-leaf node in the original dag. The
resulting dag has one new node corresponding to the added
sequence as well as copies of all internal nodes corresponding
to parents (and more ancestral nodes) to the added sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.insert_node">
<span class="sig-name descname"><span class="pre">insert_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_leaf_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_name='sequence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func=&lt;function</span> <span class="pre">TransitionModel.weighted_hamming_edge_weight.&lt;locals&gt;.edge_weight&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.insert_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.insert_node" title="Link to this definition"></a></dt>
<dd><p>Inserts a sequence into the DAG.</p>
<p>Sequence will be inserted as a child of the dagnode(s)
realizing the minimum overall distance between sequences, and also added
to the dag as a child of other nodes in such a way as to guarantee
that every tree in the DAG now contains the new sequence.</p>
<p>The choice of other nodes is computed by looking at the set of
nodes that are <cite>incompatible</cite> with the first minimizing node.
For a full description of this, see the docstring for the method-local
function <code class="docutils literal notranslate"><span class="pre">incompatible</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.postorder_above">
<span class="sig-name descname"><span class="pre">postorder_above</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_above"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.postorder_above" title="Link to this definition"></a></dt>
<dd><p>Recursive postorder traversal of all ancestors of a (possibly
internal) node. This traversal is postorder with respect to reversed
edge directions. With respect to standard edge directions (pointing
towards leaves), the traversal order guarantees that all of a node’s
parents will be visited before the node itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The node whose ancestors should be included in the
traversal. This must actually be a node in <cite>self</cite>, not simply
compare equal to a node in <cite>self</cite>.</p></li>
<li><p><strong>skip_ua_node</strong> – If True, the UA node will not be included in the traversal</p></li>
<li><p><strong>recompute_parents</strong> – If False, node parent sets will not be recomputed.
This makes many repeated calls to postorder_above much faster.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generator on nodes that lie on any path between node_as_leaf and UA node</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.postorder">
<span class="sig-name descname"><span class="pre">postorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.postorder" title="Link to this definition"></a></dt>
<dd><p>Recursive postorder traversal of the history DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generator on nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.HistoryDag.preorder">
<span class="sig-name descname"><span class="pre">preorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.preorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.HistoryDag.preorder" title="Link to this definition"></a></dt>
<dd><p>Recursive postorder traversal of the history DAG.</p>
<p>Careful! This is not guaranteed to visit a parent node before any of its children.
for that, need reverse postorder traversal.</p>
<p>If skip_ua_node is passed, the universal ancestor node will be skipped.
skip_root is provided as a backwards-compatible synonym of skip_ua_node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="historydag.HistoryDagNode.html#historydag.HistoryDagNode" title="historydag.dag_node.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generator on nodes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api.html" class="btn btn-neutral float-left" title="Description" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="historydag.HistoryDagNode.html" class="btn btn-neutral float-right" title="historydag.HistoryDagNode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Will Dumm.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>