<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>historydag.dag &mdash; historydag  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="historydag.sequence_dag" href="historydag.sequence_dag.html" />
    <link rel="prev" title="historydag.history_dag_from_histories" href="historydag.history_dag_from_histories.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> historydag
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api.html">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#classes">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#functions">Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html#modules">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">historydag.dag</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.HistoryDagNode"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.__init__"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.empty_copy"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.empty_copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.node_self"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.node_self()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.clade_union"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.clade_union()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.under_clade"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.under_clade()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.is_leaf"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.is_leaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.is_ua_node"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.is_ua_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.is_root"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.is_root()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.is_history_root"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.is_history_root()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.child_clades"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.child_clades()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.partitions"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.partitions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.sorted_child_clades"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.sorted_child_clades()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.sorted_partitions"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.sorted_partitions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.children"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.children()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.add_edge"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.add_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDagNode.remove_node"><code class="docutils literal notranslate"><span class="pre">HistoryDagNode.remove_node()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.UANode"><code class="docutils literal notranslate"><span class="pre">UANode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.UANode.__init__"><code class="docutils literal notranslate"><span class="pre">UANode.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.UANode.empty_copy"><code class="docutils literal notranslate"><span class="pre">UANode.empty_copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.UANode.is_ua_node"><code class="docutils literal notranslate"><span class="pre">UANode.is_ua_node()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.HistoryDag"><code class="docutils literal notranslate"><span class="pre">HistoryDag</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.from_history_dag"><code class="docutils literal notranslate"><span class="pre">HistoryDag.from_history_dag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.__init__"><code class="docutils literal notranslate"><span class="pre">HistoryDag.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.get_label_type"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_label_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.trim_below_weight"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_below_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.get_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.get_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.get_leaves"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_leaves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.num_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.num_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.num_leaves"><code class="docutils literal notranslate"><span class="pre">HistoryDag.num_leaves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.sample"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.nodes_above_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.nodes_above_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.sample_with_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample_with_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.sample_with_edge"><code class="docutils literal notranslate"><span class="pre">HistoryDag.sample_with_edge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.iter_covering_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.iter_covering_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.unlabel"><code class="docutils literal notranslate"><span class="pre">HistoryDag.unlabel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.relabel"><code class="docutils literal notranslate"><span class="pre">HistoryDag.relabel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.is_history"><code class="docutils literal notranslate"><span class="pre">HistoryDag.is_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.is_clade_tree"><code class="docutils literal notranslate"><span class="pre">HistoryDag.is_clade_tree()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.copy"><code class="docutils literal notranslate"><span class="pre">HistoryDag.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.merge"><code class="docutils literal notranslate"><span class="pre">HistoryDag.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.add_all_allowed_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.add_all_allowed_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.make_complete"><code class="docutils literal notranslate"><span class="pre">HistoryDag.make_complete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.to_newick"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_newick()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.to_ete"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_ete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.to_graphviz"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_graphviz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.internal_avg_parents"><code class="docutils literal notranslate"><span class="pre">HistoryDag.internal_avg_parents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.make_uniform"><code class="docutils literal notranslate"><span class="pre">HistoryDag.make_uniform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.explode_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.explode_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.leaf_path_uncertainty_dag"><code class="docutils literal notranslate"><span class="pre">HistoryDag.leaf_path_uncertainty_dag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.leaf_path_uncertainty_graphviz"><code class="docutils literal notranslate"><span class="pre">HistoryDag.leaf_path_uncertainty_graphviz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.summary"><code class="docutils literal notranslate"><span class="pre">HistoryDag.summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.label_uncertainty_summary"><code class="docutils literal notranslate"><span class="pre">HistoryDag.label_uncertainty_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.postorder_history_accum"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_history_accum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.postorder_cladetree_accum"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_cladetree_accum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.optimal_weight_annotate"><code class="docutils literal notranslate"><span class="pre">HistoryDag.optimal_weight_annotate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.weight_count"><code class="docutils literal notranslate"><span class="pre">HistoryDag.weight_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.hamming_parsimony_count"><code class="docutils literal notranslate"><span class="pre">HistoryDag.hamming_parsimony_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.to_newicks"><code class="docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_topologies"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_topologies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_topologies_fast"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_topologies_fast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_histories"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_histories()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_nodes"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_nodes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_edges"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_edges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.most_supported_trees"><code class="docutils literal notranslate"><span class="pre">HistoryDag.most_supported_trees()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_paths_to_leaf"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_paths_to_leaf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.weight_counts_with_ambiguities"><code class="docutils literal notranslate"><span class="pre">HistoryDag.weight_counts_with_ambiguities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.optimal_rf_distance"><code class="docutils literal notranslate"><span class="pre">HistoryDag.optimal_rf_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.count_rf_distances"><code class="docutils literal notranslate"><span class="pre">HistoryDag.count_rf_distances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.trim_optimal_weight"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_optimal_weight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.get_topologies"><code class="docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.trim_topology"><code class="docutils literal notranslate"><span class="pre">HistoryDag.trim_topology()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.recompute_parents"><code class="docutils literal notranslate"><span class="pre">HistoryDag.recompute_parents()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.convert_to_collapsed"><code class="docutils literal notranslate"><span class="pre">HistoryDag.convert_to_collapsed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.add_node_at_all_possible_places"><code class="docutils literal notranslate"><span class="pre">HistoryDag.add_node_at_all_possible_places()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.insert_node"><code class="docutils literal notranslate"><span class="pre">HistoryDag.insert_node()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.postorder_above"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder_above()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.postorder"><code class="docutils literal notranslate"><span class="pre">HistoryDag.postorder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.HistoryDag.preorder"><code class="docutils literal notranslate"><span class="pre">HistoryDag.preorder()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.EdgeSet"><code class="docutils literal notranslate"><span class="pre">EdgeSet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.__init__"><code class="docutils literal notranslate"><span class="pre">EdgeSet.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.set_targets"><code class="docutils literal notranslate"><span class="pre">EdgeSet.set_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.set_edge_stats"><code class="docutils literal notranslate"><span class="pre">EdgeSet.set_edge_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.shallowcopy"><code class="docutils literal notranslate"><span class="pre">EdgeSet.shallowcopy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.sample"><code class="docutils literal notranslate"><span class="pre">EdgeSet.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#historydag.dag.EdgeSet.add_to_edgeset"><code class="docutils literal notranslate"><span class="pre">EdgeSet.add_to_edgeset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.empty_node"><code class="docutils literal notranslate"><span class="pre">empty_node()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.from_tree"><code class="docutils literal notranslate"><span class="pre">from_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_trees"><code class="docutils literal notranslate"><span class="pre">history_dag_from_trees()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_etes"><code class="docutils literal notranslate"><span class="pre">history_dag_from_etes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.from_newick"><code class="docutils literal notranslate"><span class="pre">from_newick()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_newicks"><code class="docutils literal notranslate"><span class="pre">history_dag_from_newicks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_histories"><code class="docutils literal notranslate"><span class="pre">history_dag_from_histories()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_clade_trees"><code class="docutils literal notranslate"><span class="pre">history_dag_from_clade_trees()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#historydag.dag.history_dag_from_nodes"><code class="docutils literal notranslate"><span class="pre">history_dag_from_nodes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="historydag.sequence_dag.html">historydag.sequence_dag</a></li>
<li class="toctree-l2"><a class="reference internal" href="historydag.mutation_annotated_dag.html">historydag.mutation_annotated_dag</a></li>
<li class="toctree-l2"><a class="reference internal" href="historydag.utils.html">historydag.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="historydag.parsimony.html">historydag.parsimony</a></li>
<li class="toctree-l2"><a class="reference internal" href="historydag.compact_genome.html">historydag.compact_genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="historydag.counterops.html">historydag.counterops</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">historydag</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">Description</a></li>
      <li class="breadcrumb-item active">historydag.dag</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-historydag.dag">
<span id="historydag-dag"></span><h1>historydag.dag<a class="headerlink" href="#module-historydag.dag" title="Permalink to this heading"></a></h1>
<p>A module providing the class HistoryDag, and supporting functions.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.empty_node" title="historydag.dag.empty_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">empty_node</span></code></a>(label, clades[, attr])</p></td>
<td><p>Return a HistoryDagNode with the given label and clades, with no children.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.from_newick" title="historydag.dag.from_newick"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_newick</span></code></a>(tree, label_features[, ...])</p></td>
<td><p>Make a history DAG using a newick string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.from_tree" title="historydag.dag.from_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_tree</span></code></a>(treeroot, label_features[, ...])</p></td>
<td><p>Build a tree-shaped <a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag" title="historydag.HistoryDag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.HistoryDag()</span></code></a> (a 'history') object from the provided tree data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_clade_trees" title="historydag.dag.history_dag_from_clade_trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_clade_trees</span></code></a>(*args, **kwargs)</p></td>
<td><p>Deprecated name for <a class="reference internal" href="#historydag.dag.history_dag_from_histories" title="historydag.dag.history_dag_from_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">history_dag_from_histories()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_etes" title="historydag.dag.history_dag_from_etes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_etes</span></code></a>(*args, **kwargs)</p></td>
<td><p>Deprecated name for <code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.history_dag_from_trees()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_histories" title="historydag.dag.history_dag_from_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_histories</span></code></a>(treelist)</p></td>
<td><p>Build a history DAG from a list of history DAGs which are histories.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_newicks" title="historydag.dag.history_dag_from_newicks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_newicks</span></code></a>(newicklist, ...[, ...])</p></td>
<td><p>Build a history DAG from a list of newick strings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_nodes" title="historydag.dag.history_dag_from_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_nodes</span></code></a>(nodes)</p></td>
<td><p>Take an iterable containing HistoryDagNodes, and build a HistoryDag from those nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.history_dag_from_trees" title="historydag.dag.history_dag_from_trees"><code class="xref py py-obj docutils literal notranslate"><span class="pre">history_dag_from_trees</span></code></a>(treelist, ...)</p></td>
<td><p>Create a <a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag" title="historydag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">historydag.HistoryDag</span></code></a> from a list of trees.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.EdgeSet" title="historydag.dag.EdgeSet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EdgeSet</span></code></a>(*args[, weights, probs])</p></td>
<td><p>A container class for edge target nodes, and associated probabilities and weights.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>(dagroot[, attr])</p></td>
<td><p>An object to represent a collection of internally labeled trees.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>(label, clades, attr)</p></td>
<td><p>A recursive representation of a history DAG object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#historydag.dag.UANode" title="historydag.dag.UANode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UANode</span></code></a>(targetnodes)</p></td>
<td><p>A universal ancestor node, the root node of a HistoryDag.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">HistoryDagNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clades</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode" title="Permalink to this definition"></a></dt>
<dd><p>A recursive representation of a history DAG object.</p>
<ul class="simple">
<li><p>a dictionary keyed by clades (frozensets) containing EdgeSet objects</p></li>
<li><p>a label, which is a namedtuple.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clades</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.empty_copy">
<span class="sig-name descname"><span class="pre">empty_copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.empty_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.empty_copy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a HistoryDagNode object with the same clades, label, and
attr dictionary, but no descendant edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.node_self">
<span class="sig-name descname"><span class="pre">node_self</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.node_self"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.node_self" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDagNode.empty_copy" title="historydag.dag.HistoryDagNode.empty_copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">empty_copy()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.clade_union">
<span class="sig-name descname"><span class="pre">clade_union</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.clade_union"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.clade_union" title="Permalink to this definition"></a></dt>
<dd><p>Returns the union of this node’s child clades (or a set containing
only the node label, for leaf nodes.)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.FrozenSet" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenSet</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.under_clade">
<span class="sig-name descname"><span class="pre">under_clade</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.under_clade"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.under_clade" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDagNode.clade_union" title="historydag.dag.HistoryDagNode.clade_union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clade_union()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.FrozenSet" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenSet</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.is_leaf">
<span class="sig-name descname"><span class="pre">is_leaf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.is_leaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.is_leaf" title="Permalink to this definition"></a></dt>
<dd><p>Returns whether this is a leaf node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.is_ua_node">
<span class="sig-name descname"><span class="pre">is_ua_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.is_ua_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.is_ua_node" title="Permalink to this definition"></a></dt>
<dd><p>Returns whether this is the source node in the DAG, from which all
others are reachable.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.is_root">
<span class="sig-name descname"><span class="pre">is_root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.is_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.is_root" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDagNode.is_ua_node" title="historydag.dag.HistoryDagNode.is_ua_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_ua_node()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.is_history_root">
<span class="sig-name descname"><span class="pre">is_history_root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.is_history_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.is_history_root" title="Permalink to this definition"></a></dt>
<dd><p>Return whether node is a root of any histories in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.child_clades">
<span class="sig-name descname"><span class="pre">child_clades</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.child_clades"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.child_clades" title="Permalink to this definition"></a></dt>
<dd><p>Returns the node’s child clades, or a frozenset containing a
frozenset if this node is a UANode.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#frozenset" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">frozenset</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.partitions">
<span class="sig-name descname"><span class="pre">partitions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.partitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.partitions" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDagNode.child_clades" title="historydag.dag.HistoryDagNode.child_clades"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child_clades()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#frozenset" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">frozenset</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.sorted_child_clades">
<span class="sig-name descname"><span class="pre">sorted_child_clades</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.sorted_child_clades"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.sorted_child_clades" title="Permalink to this definition"></a></dt>
<dd><p>Returns the node’s child clades as a sorted tuple containing leaf
labels in sorted tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.sorted_partitions">
<span class="sig-name descname"><span class="pre">sorted_partitions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.sorted_partitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.sorted_partitions" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDagNode.sorted_child_clades" title="historydag.dag.HistoryDagNode.sorted_child_clades"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sorted_child_clades()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.children">
<span class="sig-name descname"><span class="pre">children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.children"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.children" title="Permalink to this definition"></a></dt>
<dd><p>Returns generator object containing child nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clade</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Set" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Set</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]) – If clade is provided, returns generator object of edge targets from that</p>
</dd>
</dl>
<p>clade. If no clade is provided, generator includes all children of self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.add_edge">
<span class="sig-name descname"><span class="pre">add_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.add_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.add_edge" title="Permalink to this definition"></a></dt>
<dd><p>Adds edge, if allowed and not already present.</p>
<p>Returns whether edge was added.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDagNode.remove_node">
<span class="sig-name descname"><span class="pre">remove_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodedict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDagNode.remove_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDagNode.remove_node" title="Permalink to this definition"></a></dt>
<dd><p>Recursively removes node self and any orphaned children from dag.</p>
<p>May not work on root. Does not check to make sure that parent
clade still has descendant edges.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="historydag.dag.UANode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">UANode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targetnodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#UANode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.UANode" title="Permalink to this definition"></a></dt>
<dd><p>A universal ancestor node, the root node of a HistoryDag.</p>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.UANode.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targetnodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#UANode.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.UANode.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.UANode.empty_copy">
<span class="sig-name descname"><span class="pre">empty_copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#UANode.empty_copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.UANode.empty_copy" title="Permalink to this definition"></a></dt>
<dd><p>Returns a UANode object with the same clades and label, but no
descendant edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.UANode" title="historydag.dag.UANode"><code class="xref py py-class docutils literal notranslate"><span class="pre">UANode</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.UANode.is_ua_node">
<span class="sig-name descname"><span class="pre">is_ua_node</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#UANode.is_ua_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.UANode.is_ua_node" title="Permalink to this definition"></a></dt>
<dd><p>Returns whether this is the source node in the DAG, from which all
others are reachable.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">HistoryDag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dagroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag" title="Permalink to this definition"></a></dt>
<dd><p>An object to represent a collection of internally labeled trees. A
wrapper object to contain exposed HistoryDag methods and point to a
HistoryDagNode root.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dagroot</strong> (<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>) – The root node of the history DAG</p></li>
<li><p><strong>attr</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>) – An attribute to contain data which will be preserved by copying (default and empty dict)</p></li>
</ul>
</dd>
</dl>
<p>Subclassing HistoryDag:
HistoryDag may be subclassed without overriding __init__, by defining a <cite>_required_label_fields</cite> class variable
for any subclasses.</p>
<p>The value of <cite>_required_label_fields</cite> should be a dictionary keyed by label fields that are expected by methods
of the subclass. Each dictionary entry shall be of the form <cite>required_field: [(from_fields, conversion_func), …]</cite>, where
the dict value is a list of tuples, with each <cite>conversion_func</cite> a function mapping <cite>HistoryDagNode`s to the value of
that node label’s `required_field</cite> field, and <cite>from_fields</cite> a tuple containing all label fields expected by that function.</p>
<p>Keyword arguments passed to <a class="reference internal" href="#historydag.dag.HistoryDag.from_history_dag" title="historydag.dag.HistoryDag.from_history_dag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.from_history_dag()</span></code></a> will be passed to conversion functions provided in the
appropriate subclass’s <cite>_required_label_fields</cite> attribute. Be sure to document each subclass, including available
conversion functions and their keywords, in each subclass’s docstring.</p>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.from_history_dag">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_history_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.from_history_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.from_history_dag" title="Permalink to this definition"></a></dt>
<dd><p>Converts HistoryDag instances between subclasses of HistoryDag. No
copy is performed, so the passed <cite>dag</cite> will in general be modified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dag</strong> (<a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>) – A HistoryDag (or subclass) instance</p></li>
<li><p><strong>label_fields</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A list specifying the order of label fields in node labels on the resulting HistoryDag</p></li>
<li><p><strong>kwargs</strong> – Any additional arguments required for label conversions. For details, see the class docstring
for the subclass into which the conversion is taking place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The converted HistoryDag object, carrying the type from which this static method was called.
After conversion to the new HistoryDag subclass <code class="docutils literal notranslate"><span class="pre">to_cls</span></code>, the following will be true about node labels:</p>
<ul class="simple">
<li><p>If passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> is None, then existing label fields will be preserved, except that missing
required label fields will be recovered if possible, and the existing label fields used to recover
them will be omitted. Recovered label fields will appear before the existing label fields.</p></li>
<li><p>If passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> is not None, then it must include all fields expected in node labels
in the converted history DAG object, otherwise an exception will be raised.</p></li>
<li><p>Converted node label field order will match the order of passed <code class="docutils literal notranslate"><span class="pre">label_fields</span></code>.</p></li>
<li><p>All label fields passed in <code class="docutils literal notranslate"><span class="pre">label_fields</span></code> will be included
in converted node labels, if possible. Otherwise, an exception will be raised.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dagroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.get_label_type">
<span class="sig-name descname"><span class="pre">get_label_type</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_label_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.get_label_type" title="Permalink to this definition"></a></dt>
<dd><p>Return the type for labels on this dag’s nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.trim_below_weight">
<span class="sig-name descname"><span class="pre">trim_below_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.wrapped_hamming_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_possible_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-float('inf')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_below_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.trim_below_weight" title="Permalink to this definition"></a></dt>
<dd><p>Trim the dag to contain at least all the histories within the
specified weight range.</p>
<p>Supports totally ordered weights, accumulated by addition. A
weight type must implement all ordering operators properly, as
well as + and -, and addition and subtraction must respect the
ordering. That is, if a &lt; b, then a + c &lt; b + c for any c
(including negative c)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.get_histories">
<span class="sig-name descname"><span class="pre">get_histories</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.get_histories" title="Permalink to this definition"></a></dt>
<dd><p>Return a generator containing all histories in the history DAG.</p>
<p>Note that each history is a tree-shaped history DAG, containing a UA node,
which exists as a subgraph of the history DAG.</p>
<p>The order of these histories does not necessarily match the order of
indexing. That is, <code class="docutils literal notranslate"><span class="pre">dag.get_histories()</span></code> and <code class="docutils literal notranslate"><span class="pre">history</span> <span class="pre">for</span> <span class="pre">history</span> <span class="pre">in</span>
<span class="pre">dag</span></code> will result in different orderings. <code class="docutils literal notranslate"><span class="pre">get_histories</span></code> should
be slightly faster, but possibly more memory intensive.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.get_trees">
<span class="sig-name descname"><span class="pre">get_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.get_trees" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDag.get_histories" title="historydag.dag.HistoryDag.get_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_histories()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.get_leaves">
<span class="sig-name descname"><span class="pre">get_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.get_leaves" title="Permalink to this definition"></a></dt>
<dd><p>Return a generator containing all leaf nodes in the history DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.num_nodes">
<span class="sig-name descname"><span class="pre">num_nodes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.num_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.num_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of nodes in the DAG, not counting the UA node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.num_leaves">
<span class="sig-name descname"><span class="pre">num_leaves</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.num_leaves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.num_leaves" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of leaf nodes in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_selector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.sample" title="Permalink to this definition"></a></dt>
<dd><p>Samples a history from the history DAG. (A history is a sub-history
DAG containing the root and all leaf nodes) For reproducibility, set
<code class="docutils literal notranslate"><span class="pre">random.seed</span></code> before sampling.</p>
<p>When there is an option, edges pointing to nodes on which <cite>selection_func</cite> is True
will always be chosen.</p>
<p>Returns a new HistoryDag object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.nodes_above_node">
<span class="sig-name descname"><span class="pre">nodes_above_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.nodes_above_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.nodes_above_node" title="Permalink to this definition"></a></dt>
<dd><p>Return a set of nodes from which the passed node is reachable along
directed edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Set" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Set</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.sample_with_node">
<span class="sig-name descname"><span class="pre">sample_with_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample_with_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.sample_with_node" title="Permalink to this definition"></a></dt>
<dd><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">node</span></code> from the history DAG.</p>
<p>Sampling is likely unbiased from the distribution of trees in
the DAG, conditioned on each sampled tree containing the passed
node. However, if unbiased sampling from the conditional
distribution is important, this should be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.sample_with_edge">
<span class="sig-name descname"><span class="pre">sample_with_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.sample_with_edge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.sample_with_edge" title="Permalink to this definition"></a></dt>
<dd><p>Samples a history which contains <code class="docutils literal notranslate"><span class="pre">edge</span></code> (a tuple of
HistoryDagNodes) from the history DAG.</p>
<p>Sampling is likely unbiased from the distribution of trees in
the DAG, conditioned on each sampled tree containing the passed
edge. However, if unbiased sampling from the conditional
distribution is important, this should be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.iter_covering_histories">
<span class="sig-name descname"><span class="pre">iter_covering_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cover_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.iter_covering_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.iter_covering_histories" title="Permalink to this definition"></a></dt>
<dd><p>Samples a sequence of histories which together contain all nodes in
the history DAG.</p>
<p>Histories are sampled using <a class="reference internal" href="#historydag.dag.HistoryDag.sample_with_node" title="historydag.dag.HistoryDag.sample_with_node"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_with_node()</span></code></a>, starting
with the nodes which are contained in the fewest of the DAG’s
histories. The sequence of trees is therefore non-deterministic
unless <code class="docutils literal notranslate"><span class="pre">random.seed</span></code> is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.unlabel">
<span class="sig-name descname"><span class="pre">unlabel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.unlabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.unlabel" title="Permalink to this definition"></a></dt>
<dd><p>Sets all internal node labels to be identical, and merges nodes so
that all histories in the DAG have unique topologies.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.relabel">
<span class="sig-name descname"><span class="pre">relabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relabel_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.relabel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.relabel" title="Permalink to this definition"></a></dt>
<dd><p>Return a new HistoryDag with labels modified according to a provided
function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relabel_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]) – A function which takes a node and returns the new label
appropriate for that node. The relabel_func should return a consistent
NamedTuple type with name Label. That is, all returned labels
should have matching <cite>_fields</cite> attribute.
No two leaf nodes may be mapped to the same new label.</p></li>
<li><p><strong>relax_type</strong> – Whether to require the returned HistoryDag to be of the same subclass as self.
If True, the returned HistoryDag will be of the abstract type <cite>HistoryDag</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.is_history">
<span class="sig-name descname"><span class="pre">is_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.is_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.is_history" title="Permalink to this definition"></a></dt>
<dd><p>Returns whether history DAG is a history.</p>
<p>That is, each node-clade pair has exactly one descendant edge.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.is_clade_tree">
<span class="sig-name descname"><span class="pre">is_clade_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.is_clade_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.is_clade_tree" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDag.is_history" title="historydag.dag.HistoryDag.is_history"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_history()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.copy" title="Permalink to this definition"></a></dt>
<dd><p>Uses bytestring serialization, and is guaranteed to copy:</p>
<ul class="simple">
<li><p>node labels</p></li>
<li><p>node attr attributes</p></li>
<li><p>edge weights</p></li>
<li><p>edge probabilities</p></li>
</ul>
<p>However, other object attributes will not be copied.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trees</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.merge" title="Permalink to this definition"></a></dt>
<dd><p>Graph union this history DAG with all those in a list of history
DAGs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.add_all_allowed_edges">
<span class="sig-name descname"><span class="pre">add_all_allowed_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.add_all_allowed_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.add_all_allowed_edges" title="Permalink to this definition"></a></dt>
<dd><p>Provided as a deprecated synonym for <a class="reference internal" href="#historydag.dag.HistoryDag.make_complete" title="historydag.dag.HistoryDag.make_complete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_complete()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.make_complete">
<span class="sig-name descname"><span class="pre">make_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_from_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjacent_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_parent_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.make_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.make_complete" title="Permalink to this definition"></a></dt>
<dd><p>Add all allowed edges to the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_from_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If False, no edges will be added that start at the DAG root.
Useful when attempting to constrain root label.</p></li>
<li><p><strong>adjacent_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If False, no edges will be added between nodes with the same
labels. Useful when attempting to maintain the history DAG in a ‘collapsed’
state.</p></li>
<li><p><strong>preserve_parent_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – If True, ensures that for any edge added between a
parent and child node, the parent node label was already among the original
parent labels of the child node. This ensures that parsimony score is preserved.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of edges added to the history DAG</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.to_newick">
<span class="sig-name descname"><span class="pre">to_newick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_funcs={}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_newick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.to_newick" title="Permalink to this definition"></a></dt>
<dd><p>Converts a history to extended newick format. Supports arbitrary
node names and a sequence feature. For use on a history DAG which is a
history.</p>
<p>For extracting newick representations of trees in a general history DAG, see
<a class="reference internal" href="#historydag.dag.HistoryDag.to_newicks" title="historydag.dag.HistoryDag.to_newicks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A map from nodes to newick node names</p></li>
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A list of label field names to be included in extended newick data.
If <cite>None</cite>, all label fields will be included. To include none of them,
pass an empty list.</p></li>
<li><p><strong>feature_funcs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A dictionary keyed by extended newick field names, containing
functions specifying how to populate that field for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A newick string. If <cite>features</cite> is an empty list, and feature_funcs is empty,</dt><dd><p>then this will be a standard newick string. Otherwise, it will have ete3’s
extended newick format.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.to_ete">
<span class="sig-name descname"><span class="pre">to_ete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_func=&lt;function</span> <span class="pre">HistoryDag.&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_funcs={}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_ete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.to_ete" title="Permalink to this definition"></a></dt>
<dd><p>Convert a history DAG which is a history to an ete tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A map from nodes to newick node names</p></li>
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A list of label field names to be included in extended newick data.
If <cite>None</cite>, all label fields will be included. To include none of them,
pass an empty list.</p></li>
<li><p><strong>feature_funcs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A dictionary keyed by extended newick field names, containing
functions specifying how to populate that field for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An ete3 Tree with the same topology as self, and node names and attributes
as specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.to_graphviz">
<span class="sig-name descname"><span class="pre">to_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labelfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namedict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_child_clades</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_partitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.to_graphviz" title="Permalink to this definition"></a></dt>
<dd><p>Converts history DAG to graphviz (dot format) Digraph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labelfunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]) – A function to label nodes. If None, nodes will be labeled by
their DAG node labels, or their label hash if label data is too large.</p></li>
<li><p><strong>namedict</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – A dictionary from node labels to label strings. Labelfunc will be
used instead, if both are provided.</p></li>
<li><p><strong>show_child_clades</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to include child clades in output.</p></li>
<li><p><strong>show_partitions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) – Deprecated alias for show_child_clades.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Digraph</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.internal_avg_parents">
<span class="sig-name descname"><span class="pre">internal_avg_parents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.internal_avg_parents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.internal_avg_parents" title="Permalink to this definition"></a></dt>
<dd><p>Returns the average number of parents among internal nodes.</p>
<p>A simple measure of similarity between the trees that the DAG
expresses. However, keep in mind that two trees with the same
topology but different labels would be considered entirely
unalike by this measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.make_uniform">
<span class="sig-name descname"><span class="pre">make_uniform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.make_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.make_uniform" title="Permalink to this definition"></a></dt>
<dd><p>Adjust edge probabilities so that the DAG expresses a uniform
distribution on expressed trees.</p>
<p>The probability assigned to each edge below a clade is
proportional to the number of subtrees possible below that edge.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.explode_nodes">
<span class="sig-name descname"><span class="pre">explode_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.sequence_resolutions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_node_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expandable_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.explode_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.explode_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Explode nodes according to a provided function. Adds copies of each
node to the DAG with exploded labels, but with the same parents and
children as the original node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expand_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]) – (Deprecated) A function that takes a node label, and returns an iterable
containing ‘exploded’ or ‘disambiguated’ labels corresponding to the original.
The wrapper <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.explode_label()</span></code> is provided to make such a function
easy to write.</p></li>
<li><p><strong>expand_node_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]) – A function that takes a node and returns an iterable
containing ‘exploded’ or ‘disambiguated’ labels corresponding to the
node. If provided, expand_func will be ignored.</p></li>
<li><p><strong>expandable_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]]) – A function that takes a node label, and returns whether the
iterable returned by calling expand_func on that label would contain more
than one item.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of new nodes added to the history DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.leaf_path_uncertainty_dag">
<span class="sig-name descname"><span class="pre">leaf_path_uncertainty_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.leaf_path_uncertainty_dag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.leaf_path_uncertainty_dag" title="Permalink to this definition"></a></dt>
<dd><p>Create a DAG of possible paths leading to <cite>terminal_node</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The returned path DAG will contain all paths from the
UA node ending at this node.</p></li>
<li><p><strong>node_data_func</strong> – A function accepting a HistoryDagNode and returning
data for the corresponding node in the path dag. Return type must
be a valid dictionary key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary keyed by return values of
<cite>node_data_func</cite>, with each value a dictionary keyed by child nodes,
with edge supports as values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>child_dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.leaf_path_uncertainty_graphviz">
<span class="sig-name descname"><span class="pre">leaf_path_uncertainty_graphviz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_label_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.leaf_path_uncertainty_graphviz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.leaf_path_uncertainty_graphviz" title="Permalink to this definition"></a></dt>
<dd><p>Create a graphviz DAG of possible paths leading to <cite>terminal_node</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The returned path DAG will contain all paths from the
UA node ending at this node.</p></li>
<li><p><strong>node_data_func</strong> – A function accepting a HistoryDagNode and returning
data for the corresponding node in the path dag. Return type must
be a valid dictionary key.</p></li>
<li><p><strong>node_label_func</strong> – A function accepting an object of the type returned
by <cite>node_data_func</cite>, and returning a label to be displayed on the
corresponding node.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.summary" title="Permalink to this definition"></a></dt>
<dd><p>Print nicely formatted summary about the history DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.label_uncertainty_summary">
<span class="sig-name descname"><span class="pre">label_uncertainty_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.label_uncertainty_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.label_uncertainty_summary" title="Permalink to this definition"></a></dt>
<dd><p>Print information about internal nodes which have the same child
clades but different labels.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.postorder_history_accum">
<span class="sig-name descname"><span class="pre">postorder_history_accum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_within_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_between_clade</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_above_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_history_accum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.postorder_history_accum" title="Permalink to this definition"></a></dt>
<dd><p>A template method for leaf-to-root dynamic programming.</p>
<p>Intermediate computations are stored in a <cite>_dp_data</cite> attribute on each node.
Note that a <cite>Weight</cite> can be whatever you like, such as integers, Counters,
strings, or dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function to assign weights to leaf nodes</p></li>
<li><p><strong>edge_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function to assign weights to edges. The parent node will
always be the first argument.</p></li>
<li><p><strong>accum_within_clade</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which accumulates a list of weights of subtrees
below a single clade. That is, the weights are for alternative trees.</p></li>
<li><p><strong>accum_between_clade</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which accumulates a list of weights of subtrees
below different clades. That is, the weights are for different parts of the
same tree.</p></li>
<li><p><strong>accum_above_edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – A function which adds the weight for a subtree to the weight
of the edge above it. If <cite>None</cite>, this function will be inferred from
<cite>accum_between_clade</cite>. The edge weight is the second argument.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The resulting weight computed for the History DAG UA (root) node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.postorder_cladetree_accum">
<span class="sig-name descname"><span class="pre">postorder_cladetree_accum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_cladetree_accum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.postorder_cladetree_accum" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDag.postorder_history_accum" title="historydag.dag.HistoryDag.postorder_history_accum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.postorder_history_accum()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.optimal_weight_annotate">
<span class="sig-name descname"><span class="pre">optimal_weight_annotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.wrapped_hamming_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.optimal_weight_annotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.optimal_weight_annotate" title="Permalink to this definition"></a></dt>
<dd><p>A template method for finding the optimal tree weight in the DAG.
Dynamically annotates each node in the DAG with the optimal weight of a
clade sub-tree beneath it, so that the DAG root node is annotated with
the optimal weight of a history in the DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns starting weights to leaves.</p></li>
<li><p><strong>edge_weight_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns weights to DAG edges based on the
parent node and the child node, in that order.</p></li>
<li><p><strong>accum_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which takes a list of weights of different parts of a
tree, and returns a weight, like sum.</p></li>
<li><p><strong>optimal_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which takes a list of weights and returns the optimal
one, like min.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The optimal weight of a tree under the DAG UA node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.weight_count">
<span class="sig-name descname"><span class="pre">weight_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.wrapped_hamming_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sum</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.weight_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.weight_count" title="Permalink to this definition"></a></dt>
<dd><p>A template method for counting weights of trees expressed in the
history DAG.</p>
<p>Weights must be hashable, but may otherwise be of arbitrary type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns a weight to each leaf node</p></li>
<li><p><strong>edge_func</strong> – A function which assigns a weight to pairs of labels, with the
parent node label the first argument</p></li>
<li><p><strong>accum_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A way to ‘add’ a list of weights together</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Counter keyed by weights.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.hamming_parsimony_count">
<span class="sig-name descname"><span class="pre">hamming_parsimony_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.hamming_parsimony_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.hamming_parsimony_count" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated in favor of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sequence_dag.SequenceHistoryDag.hamming_parsimony_count()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.to_newicks">
<span class="sig-name descname"><span class="pre">to_newicks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.to_newicks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.to_newicks" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of extended newick strings formed with label fields.</p>
<p>Arguments are passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_newickcountfuncs()</span></code>.
Arguments are the same as for
<a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag.to_newick" title="historydag.HistoryDag.to_newick"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.HistoryDag.to_newick()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_topologies">
<span class="sig-name descname"><span class="pre">count_topologies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_topologies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_topologies" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of unique topologies in the history DAG. This is
achieved by counting the number of unique newick strings with only
leaves labeled.</p>
<p><a class="reference internal" href="#historydag.dag.HistoryDag.count_histories" title="historydag.dag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_histories()</span></code></a> gives the total number of unique trees in the DAG, taking
into account internal node labels.</p>
<p>For large DAGs, this method is prohibitively slow. Use <a class="reference internal" href="#historydag.dag.HistoryDag.count_topologies_fast" title="historydag.dag.HistoryDag.count_topologies_fast"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_topologies_fast()</span></code></a> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>collapse_leaves</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – By default, topologies are counted as-is in the DAG. However,
even if the DAG is collapsed by label, edges above leaf nodes will not be collapsed.
if <cite>collapse_leaves</cite> is True, then the number of unique topologies with all
leaf-adjacent edges collapsed will be counted. Assumes that the DAG is collapsed
with <a class="reference internal" href="#historydag.dag.HistoryDag.convert_to_collapsed" title="historydag.dag.HistoryDag.convert_to_collapsed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.convert_to_collapsed()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of topologies in the history DAG</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_topologies_fast">
<span class="sig-name descname"><span class="pre">count_topologies_fast</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_topologies_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_topologies_fast" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of unique topologies in the history DAG.</p>
<p>This is achieved by creating a new history DAG in which all
internal nodes have matching labels.</p>
<p>This is only guaranteed to match the output of <code class="docutils literal notranslate"><span class="pre">count_topologies</span></code>
if the DAG has all allowed edges added.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_trees">
<span class="sig-name descname"><span class="pre">count_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_trees" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.HistoryDag.count_histories" title="historydag.dag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_histories()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_histories">
<span class="sig-name descname"><span class="pre">count_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_count_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">ls:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_histories" title="Permalink to this definition"></a></dt>
<dd><p>Annotates each node in the DAG with the number of clade sub-trees
underneath.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expand_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]) – A function which takes a label and returns a list of labels, for
example disambiguations of an ambiguous sequence. If provided, this method
will count at least the number of histories that would be in the DAG,
if <a class="reference internal" href="#historydag.dag.HistoryDag.explode_nodes" title="historydag.dag.HistoryDag.explode_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">explode_nodes()</span></code></a> were called with the same <cite>expand_func</cite>.</p></li>
<li><p><strong>expand_count_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – A function which takes a label and returns an integer value
corresponding to the number of ‘disambiguations’ of that label. If provided,
<cite>expand_func</cite> will be used to find this value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The total number of unique complete trees below the root node. If <cite>expand_func</cite>
or <cite>expand_count_func</cite> is provided, the complete trees being counted are not
guaranteed to be unique.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_nodes">
<span class="sig-name descname"><span class="pre">count_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of trees each node takes part in.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>collapse</strong> – A flag that when set to true, treats nodes as clade unions and
ignores label information. Then, the returned dictionary is keyed by
clade union sets.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dicitonary mapping each node in the DAG to the number of trees
that it takes part in.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_edges">
<span class="sig-name descname"><span class="pre">count_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_edges" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of trees each edge takes part in.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dicitonary mapping each edge in the DAG to the number of trees
that it takes part in.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.most_supported_trees">
<span class="sig-name descname"><span class="pre">most_supported_trees</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.most_supported_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.most_supported_trees" title="Permalink to this definition"></a></dt>
<dd><p>Trims the DAG to only express the trees that have the highest
support.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_paths_to_leaf">
<span class="sig-name descname"><span class="pre">count_paths_to_leaf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">leaf_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_count_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">ls:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_paths_to_leaf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_paths_to_leaf" title="Permalink to this definition"></a></dt>
<dd><p>Annotates each node in the DAG with the number of paths to
<code class="docutils literal notranslate"><span class="pre">leaf_label</span></code> underneath.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>leaf_label</strong> – The label of the leaf node of interest</p></li>
<li><p><strong>expand_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]]) – A function which takes a label and returns a list of labels, for
example disambiguations of an ambiguous sequence. If provided, this method
will count at least the number of histories that would be in the DAG,
if <a class="reference internal" href="#historydag.dag.HistoryDag.explode_nodes" title="historydag.dag.HistoryDag.explode_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">explode_nodes()</span></code></a> were called with the same <cite>expand_func</cite>.</p></li>
<li><p><strong>expand_count_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]) – A function which takes a label and returns an integer value
corresponding to the number of ‘disambiguations’ of that label. If provided,
<cite>expand_func</cite> will be used to find this value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The total number of unique paths to the leaf node of interest. If <cite>expand_func</cite>
or <cite>expand_count_func</cite> is provided, the paths being counted are not guaranteed
to be unique.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.weight_counts_with_ambiguities">
<span class="sig-name descname"><span class="pre">weight_counts_with_ambiguities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">l1,</span> <span class="pre">l2:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.sequence_resolutions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.weight_counts_with_ambiguities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.weight_counts_with_ambiguities" title="Permalink to this definition"></a></dt>
<dd><p>Template method for counting tree weights in the DAG, with exploded
labels. Like <a class="reference internal" href="#historydag.dag.HistoryDag.weight_count" title="historydag.dag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.weight_count()</span></code></a>, but creates dictionaries
of Counter objects at each node, keyed by possible sequences at that
node. Analogous to <a class="reference internal" href="#historydag.dag.HistoryDag.count_histories" title="historydag.dag.HistoryDag.count_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.count_histories()</span></code></a> with
<cite>expand_func</cite> provided.</p>
<p>Weights must be hashable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns a weight to each leaf node</p></li>
<li><p><strong>edge_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns a weight to pairs of labels, with the
parent node label the first argument. Must correctly handle the UA
node label which is a UALabel instead of a namedtuple.</p></li>
<li><p><strong>accum_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A way to ‘add’ a list of weights together</p></li>
<li><p><strong>expand_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.NamedTuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a>, <a class="reference internal" href="historydag.utils.html#historydag.utils.UALabel" title="historydag.utils.UALabel"><code class="xref py py-class docutils literal notranslate"><span class="pre">UALabel</span></code></a>]]]) – A function which takes a label and returns a list of labels, such
as disambiguations of an ambiguous sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Counter keyed by weights.
The total number of trees will be greater than count_histories(), as these are
possible disambiguations of trees. These disambiguations may not be unique,
but if two are the same, they come from different subtrees of the DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.optimal_rf_distance">
<span class="sig-name descname"><span class="pre">optimal_rf_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.optimal_rf_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.optimal_rf_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns the optimal (min or max) RF distance to a given history.</p>
<p>The given history must be on the same taxa as all trees in the DAG.
Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.dag.HistoryDag.optimal_weight_annotate" title="historydag.dag.HistoryDag.optimal_weight_annotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optimal_weight_annotate()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.count_rf_distances">
<span class="sig-name descname"><span class="pre">count_rf_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rooted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.count_rf_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.count_rf_distances" title="Permalink to this definition"></a></dt>
<dd><p>Returns a Counter containing all RF distances to a given history.</p>
<p>The given history must be on the same taxa as all trees in the DAG.</p>
<p>Since computing reference splits is expensive, it is better to use
<a class="reference internal" href="#historydag.dag.HistoryDag.weight_count" title="historydag.dag.HistoryDag.weight_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">weight_count()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">utils.make_rfdistance_countfuncs()</span></code>
instead of making multiple calls to this method with the same reference
history.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.trim_optimal_weight">
<span class="sig-name descname"><span class="pre">trim_optimal_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.wrapped_hamming_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accum_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">w1,</span> <span class="pre">w2:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_optimal_weight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.trim_optimal_weight" title="Permalink to this definition"></a></dt>
<dd><p>Trims the DAG to only express trees with optimal weight. This is
guaranteed to be possible when edge_weight_func depends only on the
labels of an edge’s parent and child node.</p>
<p>Requires that weights are of a type that supports reliable equality
testing. In particular, floats are not recommended. Instead, consider
defining weights to be a precursor type, and define <cite>optimal_func</cite> to
choose the one whose corresponding float is maximized/minimized.</p>
<p>If floats must be used, a Numpy type may help.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns starting weights to leaves.</p></li>
<li><p><strong>edge_weight_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which assigns weights to DAG edges based on the
parent node and the child node, in that order.</p></li>
<li><p><strong>accum_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which takes a list of weights of different parts of a tree,
and returns a weight, like sum.</p></li>
<li><p><strong>optimal_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – A function which takes a list of weights and returns the optimal
one, like min.</p></li>
<li><p><strong>eq_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]) – A function which tests equality, taking a pair of weights and returning a bool.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.get_topologies">
<span class="sig-name descname"><span class="pre">get_topologies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.get_topologies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.get_topologies" title="Permalink to this definition"></a></dt>
<dd><p>Return a list of pseudo-newick representations of topologies in the
history DAG.</p>
<p>The newicks returned are not well-formed, and are for use with
<a class="reference internal" href="#historydag.dag.HistoryDag.trim_topology" title="historydag.dag.HistoryDag.trim_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.trim_topology()</span></code></a>. Otherwise, this method would be equivalent to
<a class="reference internal" href="#historydag.dag.HistoryDag.to_newicks" title="historydag.dag.HistoryDag.to_newicks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.to_newicks()</span></code></a> with keyword arguments <code class="docutils literal notranslate"><span class="pre">internal_labels=False</span></code> and
<code class="docutils literal notranslate"><span class="pre">collapsed_leaves</span></code> as desired.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>collapse_leaves</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to collapse leaf-adjacent edges between nodes with
matching labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of strings, each representing a topology present in the history DAG.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.trim_topology">
<span class="sig-name descname"><span class="pre">trim_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse_leaves</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.trim_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.trim_topology" title="Permalink to this definition"></a></dt>
<dd><p>Trims the history DAG to express only trees matching the provided
topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – A string like one output by <a class="reference internal" href="#historydag.dag.HistoryDag.get_topologies" title="historydag.dag.HistoryDag.get_topologies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a></p></li>
<li><p><strong>collapse_leaves</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – must match the same argument provided to <a class="reference internal" href="#historydag.dag.HistoryDag.get_topologies" title="historydag.dag.HistoryDag.get_topologies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HistoryDag.get_topologies()</span></code></a>
when creating the string passed as <code class="docutils literal notranslate"><span class="pre">topology</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.recompute_parents">
<span class="sig-name descname"><span class="pre">recompute_parents</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.recompute_parents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.recompute_parents" title="Permalink to this definition"></a></dt>
<dd><p>Repopulate <code class="docutils literal notranslate"><span class="pre">HistoryDagNode.parent</span></code> attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.convert_to_collapsed">
<span class="sig-name descname"><span class="pre">convert_to_collapsed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.convert_to_collapsed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.convert_to_collapsed" title="Permalink to this definition"></a></dt>
<dd><p>Rebuilds the DAG so that no edge connects two nodes with the same
label, unless one is a leaf node.</p>
<p>The resulting DAG should express at least the collapsed
histories present in the original.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.add_node_at_all_possible_places">
<span class="sig-name descname"><span class="pre">add_node_at_all_possible_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_leaf_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sequence'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.add_node_at_all_possible_places"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.add_node_at_all_possible_places" title="Permalink to this definition"></a></dt>
<dd><p>Inserts a sequence into the dag such that every tree in the dag now
contains that new node.</p>
<p>This method adds the new node as a leaf node by connecting it as
a child of every non-leaf node in the original dag. The
resulting dag has one new node corresponding to the added
sequence as well as copies of all internal nodes corresponding
to parents (and more ancestral nodes) to the added sequence.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.insert_node">
<span class="sig-name descname"><span class="pre">insert_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_leaf_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sequence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">utils.wrapped_hamming_distance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.insert_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.insert_node" title="Permalink to this definition"></a></dt>
<dd><p>Inserts a sequence into the DAG.</p>
<p>Sequence will be inserted as a child of the dagnode(s)
realizing the minimum overall distance between sequences, and also added
to the dag as a child of other nodes in such a way as to guarantee
that every tree in the DAG now contains the new sequence.</p>
<p>The choice of other nodes is computed by looking at the set of
nodes that are <cite>incompatible</cite> with the first minimizing node.
For a full description of this, see the docstring for the method-local
function <code class="docutils literal notranslate"><span class="pre">incompatible</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.postorder_above">
<span class="sig-name descname"><span class="pre">postorder_above</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">terminal_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recompute_parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder_above"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.postorder_above" title="Permalink to this definition"></a></dt>
<dd><p>Recursive postorder traversal of all ancestors of a (possibly
internal) node. This traversal is postorder with respect to reversed
edge directions. With respect to standard edge directions (pointing
towards leaves), the traversal order guarantees that all of a node’s
parents will be visited before the node itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>terminal_node</strong> – The node whose ancestors should be included in the
traversal. This must actually be a node in <cite>self</cite>, not simply
compare equal to a node in <cite>self</cite>.</p></li>
<li><p><strong>skip_ua_node</strong> – If True, the UA node will not be included in the traversal</p></li>
<li><p><strong>recompute_parents</strong> – If False, node parent sets will not be recomputed.
This makes many repeated calls to postorder_above much faster.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Generator on nodes that lie on any path between node_as_leaf and UA node</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.postorder">
<span class="sig-name descname"><span class="pre">postorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.postorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.postorder" title="Permalink to this definition"></a></dt>
<dd><p>Recursive postorder traversal of the history DAG.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Generator on nodes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.HistoryDag.preorder">
<span class="sig-name descname"><span class="pre">preorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_ua_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#HistoryDag.preorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.HistoryDag.preorder" title="Permalink to this definition"></a></dt>
<dd><p>Recursive postorder traversal of the history DAG.</p>
<p>Careful! This is not guaranteed to visit a parent node before any of its children.
for that, need reverse postorder traversal.</p>
<p>If skip_ua_node is passed, the universal ancestor node will be skipped.
skip_root is provided as a backwards-compatible synonym of skip_ua_node.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generator" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Generator on nodes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">EdgeSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet" title="Permalink to this definition"></a></dt>
<dd><p>A container class for edge target nodes, and associated probabilities
and weights.</p>
<p>Goal: associate targets (edges) with arbitrary parameters, but support
set-like operations like lookup and enforce that elements are unique.</p>
<p>Takes no arguments, or an ordered iterable containing target
nodes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Takes no arguments, or an ordered iterable containing target
nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.set_targets">
<span class="sig-name descname"><span class="pre">set_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.set_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.set_targets" title="Permalink to this definition"></a></dt>
<dd><p>Set the target nodes of this node.</p>
<p>If no weights or probabilities are provided, then these will be
set to 0 and 1/n, respectively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.set_edge_stats">
<span class="sig-name descname"><span class="pre">set_edge_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.set_edge_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.set_edge_stats" title="Permalink to this definition"></a></dt>
<dd><p>Set the edge weights and/or probabilities of this EdgeSet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.shallowcopy">
<span class="sig-name descname"><span class="pre">shallowcopy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.shallowcopy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.shallowcopy" title="Permalink to this definition"></a></dt>
<dd><p>Return an identical EdgeSet object, which points to the same target
nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.EdgeSet" title="historydag.dag.EdgeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">EdgeSet</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.sample" title="Permalink to this definition"></a></dt>
<dd><p>Returns a randomly sampled child edge, and its corresponding weight.</p>
<p>When possible, only edges pointing to child nodes on which
<code class="docutils literal notranslate"><span class="pre">selection_function</span></code> evaluates to True will be sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="historydag.dag.EdgeSet.add_to_edgeset">
<span class="sig-name descname"><span class="pre">add_to_edgeset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#EdgeSet.add_to_edgeset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.EdgeSet.add_to_edgeset" title="Permalink to this definition"></a></dt>
<dd><p>Add a target node to the EdgeSet.</p>
<p>currently does nothing if edge is already present. Also does nothing
if the target node has one child clade, and parent node is not the DAG root.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> – target node</p></li>
<li><p><strong>weight</strong> – edge weight</p></li>
<li><p><strong>prob</strong> – edge probability. If not provided, edge probability will be
1 / n where n is the number of edges in the edgeset.</p></li>
<li><p><strong>prob_norm</strong> – if True, probability vector will be normalized.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether an edge was added</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.empty_node">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">empty_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clades</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#empty_node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.empty_node" title="Permalink to this definition"></a></dt>
<dd><p>Return a HistoryDagNode with the given label and clades, with no
children.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDagNode" title="historydag.dag.HistoryDagNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDagNode</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.from_tree">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">from_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treeroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_node_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_node_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ete3.TreeNode.get_leaves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_weight_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#from_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.from_tree" title="Permalink to this definition"></a></dt>
<dd><p>Build a tree-shaped <a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag" title="historydag.HistoryDag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.HistoryDag()</span></code></a> (a ‘history’) object
from the provided tree data.</p>
<p>Default arguments are suitable for loading a <code class="xref py py-class docutils literal notranslate"><span class="pre">ete3.Tree</span></code>, but by providing
appropriate <cite>child_node_func</cite> and <cite>leaf_node_func</cite>, any data structure implementing
a tree can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>treeroot</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>) – The root node of a tree to be converted to HistoryDag history</p></li>
<li><p><strong>label_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – tree node attribute names to be used as HistoryDagNode label fields.
Each attribute name must be accessible by <code class="docutils literal notranslate"><span class="pre">getattr(treenode,</span> <span class="pre">name)</span></code>.
Field names provided in <cite>label_functions</cite> will take precedence.</p></li>
<li><p><strong>label_functions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – dictionary keyed by additional label field names, containing
functions mapping tree nodes to intended label field values.</p></li>
<li><p><strong>attr_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – function to populate HistoryDag node <cite>attr</cite> attribute,
which is not used to distinguish nodes, and may be overwritten
by <cite>attr</cite> of another node with the same label and child clades.</p></li>
<li><p><strong>child_node_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>]]) – function taking a tree node and returning an iterable
containing the node’s children. By default, accesses node’s
<cite>children</cite> attribute.</p></li>
<li><p><strong>leaf_node_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>]]) – function accepting a tree node and returning an iterable
containing the leaf nodes accessible from that node.</p></li>
<li><p><strong>edge_weight_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – function accepting a tree node and returning the weight
of that node’s parent edge.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>HistoryDag object, which has the same topology as the input tree, with the required
UA node added as a new root.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_trees">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_features</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_trees" title="Permalink to this definition"></a></dt>
<dd><p>Create a <a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag" title="historydag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">historydag.HistoryDag</span></code></a> from a list of trees.</p>
<p>Default arguments are suitable for loading lists of <code class="xref py py-class docutils literal notranslate"><span class="pre">ete3.Tree`s,</span> <span class="pre">but</span>
<span class="pre">any</span> <span class="pre">tree</span> <span class="pre">data</span> <span class="pre">structure</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">by</span> <span class="pre">providing</span> <span class="pre">appropriate</span> <span class="pre">functions</span> <span class="pre">to</span>
<span class="pre">`child_node_func</span></code> and <cite>leaf_node_func</cite> keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>treelist</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>]) – List of root nodes of input trees.</p></li>
<li><p><strong>label_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – tree node attribute names to be used as HistoryDagNode label fields.
Each attribute name must be accessible by <code class="docutils literal notranslate"><span class="pre">getattr(treenode,</span> <span class="pre">name)</span></code>.
Field names provided in <cite>label_functions</cite> keyword argument will take precedence.</p></li>
<li><p><strong>kwargs</strong> – Passed to <a class="reference internal" href="historydag.from_tree.html#historydag.from_tree" title="historydag.from_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.from_tree()</span></code></a>. See docstring
for that method for argument details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="historydag.HistoryDag.html#historydag.HistoryDag" title="historydag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">historydag.HistoryDag</span></code></a> constructed from input trees.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_etes">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_etes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_etes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_etes" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <code class="xref py py-meth docutils literal notranslate"><span class="pre">historydag.history_dag_from_trees()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.from_newick">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">from_newick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newick_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#from_newick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.from_newick" title="Permalink to this definition"></a></dt>
<dd><p>Make a history DAG using a newick string. Internally, utilizes newick
parsing features provided by ete3, then calls <a class="reference internal" href="#historydag.dag.from_tree" title="historydag.dag.from_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_tree()</span></code></a> on the
resulting ete3.Tree object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – newick string representation of a tree. May contain extended node data
in ‘extended newick format’ used by ete3.</p></li>
<li><p><strong>label_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – (passed to <a class="reference internal" href="#historydag.dag.from_tree" title="historydag.dag.from_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_tree()</span></code></a>) list of features to be used as label
fields in resulting history DAG.  ‘name’ refers to the node name string in the
standard newick format. See ete3 docs for more details.</p></li>
<li><p><strong>newick_format</strong> – ete3 format number of passed newick string. See ete3 docs for details.</p></li>
<li><p><strong>label_functions</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapping</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]) – (passed to <a class="reference internal" href="#historydag.dag.from_tree" title="historydag.dag.from_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_tree()</span></code></a>)</p></li>
<li><p><strong>attr_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">TreeNode</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]) – (passed to <a class="reference internal" href="#historydag.dag.from_tree" title="historydag.dag.from_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_tree()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>HistoryDag object, which has the same topology as the input newick tree, with the
required UA node added as a new root.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_newicks">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_newicks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newicklist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">lambda</span> <span class="pre">n:</span> <span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newick_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_newicks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_newicks" title="Permalink to this definition"></a></dt>
<dd><p>Build a history DAG from a list of newick strings.</p>
<p>See <a class="reference internal" href="#historydag.dag.from_newick" title="historydag.dag.from_newick"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_newick()</span></code></a> for argument details.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_histories">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treelist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_histories" title="Permalink to this definition"></a></dt>
<dd><p>Build a history DAG from a list of history DAGs which are histories.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_clade_trees">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_clade_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_clade_trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_clade_trees" title="Permalink to this definition"></a></dt>
<dd><p>Deprecated name for <a class="reference internal" href="#historydag.dag.history_dag_from_histories" title="historydag.dag.history_dag_from_histories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">history_dag_from_histories()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="historydag.dag.history_dag_from_nodes">
<span class="sig-prename descclassname"><span class="pre">historydag.dag.</span></span><span class="sig-name descname"><span class="pre">history_dag_from_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/historydag/dag.html#history_dag_from_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#historydag.dag.history_dag_from_nodes" title="Permalink to this definition"></a></dt>
<dd><p>Take an iterable containing HistoryDagNodes, and build a HistoryDag from
those nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#historydag.dag.HistoryDag" title="historydag.dag.HistoryDag"><code class="xref py py-class docutils literal notranslate"><span class="pre">HistoryDag</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="historydag.history_dag_from_histories.html" class="btn btn-neutral float-left" title="historydag.history_dag_from_histories" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="historydag.sequence_dag.html" class="btn btn-neutral float-right" title="historydag.sequence_dag" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Will Dumm.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>